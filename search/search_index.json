{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Ksobrenatural's notes Some of my notes and useful commands that help me remember flags, command structures, and use cases without searching around. Navigation Backup CLI Containers DNS blocky-config.yml unbound.conf Git Network Cisco interfaces nftables.conf Sysadmin SELinux CoreOS Databases ERPNext WordPress basic.bu Systemd Examples app.service freedns.service freedns.timer rclone.service sshd_config wg-gen.sh Virtual Machine Web","title":"Home"},{"location":"#ksobrenaturals-notes","text":"Some of my notes and useful commands that help me remember flags, command structures, and use cases without searching around.","title":"Ksobrenatural's notes"},{"location":"#navigation","text":"Backup CLI Containers DNS blocky-config.yml unbound.conf Git Network Cisco interfaces nftables.conf Sysadmin SELinux CoreOS Databases ERPNext WordPress basic.bu Systemd Examples app.service freedns.service freedns.timer rclone.service sshd_config wg-gen.sh Virtual Machine Web","title":"Navigation"},{"location":"backup/backup-notes/","text":"Backup Notes Utilities Tar Tar is great for creating archives of multiple directories or files into a single file. It also supports compression and can be combined with other tools for encryption and integrity checks. Usage Compressing directories into a .txz archive: tar -cJf file.txz /path/to/directorie/1 /path/to/directorie/2 Use \"-J\" to use the xz protocol. Use \"-cf\" to create a new file. Using multithreading compression: tar -cf - /path/to/directorie/1 /path/to/directorie/2 | xz -z -T0 -9 > file.txz \"-T0\" uses all available CPU cores. \"-9\" is the maximum compression level. Extracting an archive: tar -xJf file.txz GPG GPG can be used to encrypt files for secure storage or transfer. Usage Create a keypair: gpg --full-generate-key Get key information: gpg --list-keys For the key ID, use the long format (16 characters). gpg --list-keys --keyid-format LONG Export public key: gpg --export --armor <recipient_key_id> > publickey.asc Import public key: gpg --import publickey.asc Export secret key for backup: gpg -o private-backup.gpg --export-options backup --export-secret-keys <email_or_key_id> Import the backup key: gpg --import-options restore --import private-backup.gpg gpg --edit-key username@example.com > trust > 5 (ultimately) > save Encrypt a file with a recipient gpg --encrypt --recipient <recipient_key_id> file Decrypt a file gpg --decrypt file.gpg > file Encrypt a file with password gpg --encrypt --symmetric file Rsync Rsync is a powerful tool for synchronizing files and directories between two locations, either locally or over a network. Usage rsync -arzuvhP /path/to/source /path/to/destiny \"a\" for archive mode \"r\" for recursive \"z\" for compression on transit (useful in network) \"u\" for skipping files newer on receiver \"v\" for verbose \"h\" for human readable \"P\" for progress \"c\" for checksum \"i\" for showing changes in a verbose mode \"--ignore-existing\" for leaving untouched the files on destination \"-delete\" for deleting files on destination \"-n\" for dry run When using -i (--itemize-changes) the output of the changes will be more verbose of why the changes are being done, running it with --dry-run is a secure practice in case you want to use -delete, the output description is: YXcstpoguax path/to/file ||||||||||| `----------- the type of update being done:: |||||||||| <: file is being transferred to the remote host (sent). |||||||||| >: file is being transferred to the local host (received). |||||||||| c: local change/creation for the item, such as: |||||||||| - the creation of a directory |||||||||| - the changing of a symlink, |||||||||| - etc. |||||||||| h: the item is a hard link to another item (requires --hard-links). |||||||||| .: the item is not being updated (though it might have attributes that are being modified). |||||||||| *: means that the rest of the itemized-output area contains a message (e.g. \"deleting\"). |||||||||| `---------- the file type: ||||||||| f for a file, ||||||||| d for a directory, ||||||||| L for a symlink, ||||||||| D for a device, ||||||||| S for a special file (e.g. named sockets and fifos). ||||||||| `--------- c: different checksum (for regular files) |||||||| changed value (for symlink, device, and special file) `-------- s: Size is different `------- t: Modification time is different `------ p: Permission are different `----- o: Owner is different `---- g: Group is different `--- u: The u slot is reserved for future use. `-- a: The ACL information changed Btrfs Btrfs is a modern filesystem that supports advanced features like snapshots, subvolumes, and built-in RAID support. It is well-suited for backup solutions due to its snapshot capabilities and efficient storage management. Usage Format a partition with Btrfs: sudo mkfs.btrfs /dev/sdXn To mount a Btrfs filesystem: sudo mount -o options -t btrfs /dev/sdXn /mnt/point Options can include: \"compress=zstd\" for compression (also supported: lzo, zlis) \"noatime\" to disable access time updates \"subvol=subvolume_name\" to mount a specific subvolume \"space_cache=v2\" for improved space cache management \"autodefrag\" to enable automatic defragmentation Taking a snapshot: sudo btrfs subvolume snapshot -r /mnt/point/subvolume /mnt/point/snapshot_name Sending a snapshot to another location: sudo btrfs send /mnt/point/snapshot_name | sudo btrfs receive /mnt/dest/point Sending an incremental snapshot: sudo btrfs send -p /mnt/point/snapshot_previous /mnt/point/snapshot_new | sudo btrfs receive /mnt/dest/point Delete a snapshot: sudo btrfs subvolume delete /mnt/point/snapshot_name","title":"Backup"},{"location":"backup/backup-notes/#backup-notes","text":"","title":"Backup Notes"},{"location":"backup/backup-notes/#utilities","text":"","title":"Utilities"},{"location":"backup/backup-notes/#tar","text":"Tar is great for creating archives of multiple directories or files into a single file. It also supports compression and can be combined with other tools for encryption and integrity checks.","title":"Tar"},{"location":"backup/backup-notes/#usage","text":"Compressing directories into a .txz archive: tar -cJf file.txz /path/to/directorie/1 /path/to/directorie/2 Use \"-J\" to use the xz protocol. Use \"-cf\" to create a new file. Using multithreading compression: tar -cf - /path/to/directorie/1 /path/to/directorie/2 | xz -z -T0 -9 > file.txz \"-T0\" uses all available CPU cores. \"-9\" is the maximum compression level. Extracting an archive: tar -xJf file.txz","title":"Usage"},{"location":"backup/backup-notes/#gpg","text":"GPG can be used to encrypt files for secure storage or transfer.","title":"GPG"},{"location":"backup/backup-notes/#usage_1","text":"Create a keypair: gpg --full-generate-key Get key information: gpg --list-keys For the key ID, use the long format (16 characters). gpg --list-keys --keyid-format LONG Export public key: gpg --export --armor <recipient_key_id> > publickey.asc Import public key: gpg --import publickey.asc Export secret key for backup: gpg -o private-backup.gpg --export-options backup --export-secret-keys <email_or_key_id> Import the backup key: gpg --import-options restore --import private-backup.gpg gpg --edit-key username@example.com > trust > 5 (ultimately) > save Encrypt a file with a recipient gpg --encrypt --recipient <recipient_key_id> file Decrypt a file gpg --decrypt file.gpg > file Encrypt a file with password gpg --encrypt --symmetric file","title":"Usage"},{"location":"backup/backup-notes/#rsync","text":"Rsync is a powerful tool for synchronizing files and directories between two locations, either locally or over a network.","title":"Rsync"},{"location":"backup/backup-notes/#usage_2","text":"rsync -arzuvhP /path/to/source /path/to/destiny \"a\" for archive mode \"r\" for recursive \"z\" for compression on transit (useful in network) \"u\" for skipping files newer on receiver \"v\" for verbose \"h\" for human readable \"P\" for progress \"c\" for checksum \"i\" for showing changes in a verbose mode \"--ignore-existing\" for leaving untouched the files on destination \"-delete\" for deleting files on destination \"-n\" for dry run When using -i (--itemize-changes) the output of the changes will be more verbose of why the changes are being done, running it with --dry-run is a secure practice in case you want to use -delete, the output description is: YXcstpoguax path/to/file ||||||||||| `----------- the type of update being done:: |||||||||| <: file is being transferred to the remote host (sent). |||||||||| >: file is being transferred to the local host (received). |||||||||| c: local change/creation for the item, such as: |||||||||| - the creation of a directory |||||||||| - the changing of a symlink, |||||||||| - etc. |||||||||| h: the item is a hard link to another item (requires --hard-links). |||||||||| .: the item is not being updated (though it might have attributes that are being modified). |||||||||| *: means that the rest of the itemized-output area contains a message (e.g. \"deleting\"). |||||||||| `---------- the file type: ||||||||| f for a file, ||||||||| d for a directory, ||||||||| L for a symlink, ||||||||| D for a device, ||||||||| S for a special file (e.g. named sockets and fifos). ||||||||| `--------- c: different checksum (for regular files) |||||||| changed value (for symlink, device, and special file) `-------- s: Size is different `------- t: Modification time is different `------ p: Permission are different `----- o: Owner is different `---- g: Group is different `--- u: The u slot is reserved for future use. `-- a: The ACL information changed","title":"Usage"},{"location":"backup/backup-notes/#btrfs","text":"Btrfs is a modern filesystem that supports advanced features like snapshots, subvolumes, and built-in RAID support. It is well-suited for backup solutions due to its snapshot capabilities and efficient storage management.","title":"Btrfs"},{"location":"backup/backup-notes/#usage_3","text":"Format a partition with Btrfs: sudo mkfs.btrfs /dev/sdXn To mount a Btrfs filesystem: sudo mount -o options -t btrfs /dev/sdXn /mnt/point Options can include: \"compress=zstd\" for compression (also supported: lzo, zlis) \"noatime\" to disable access time updates \"subvol=subvolume_name\" to mount a specific subvolume \"space_cache=v2\" for improved space cache management \"autodefrag\" to enable automatic defragmentation Taking a snapshot: sudo btrfs subvolume snapshot -r /mnt/point/subvolume /mnt/point/snapshot_name Sending a snapshot to another location: sudo btrfs send /mnt/point/snapshot_name | sudo btrfs receive /mnt/dest/point Sending an incremental snapshot: sudo btrfs send -p /mnt/point/snapshot_previous /mnt/point/snapshot_new | sudo btrfs receive /mnt/dest/point Delete a snapshot: sudo btrfs subvolume delete /mnt/point/snapshot_name","title":"Usage"},{"location":"cli/cli-notes/","text":"Command line use notes Bash notes For compatibility, use this as shebang on scripts: #!/usr/bin/env bash Temporarily disable the bash history set +o history Some useful parameters on scripts set -e # exit on error set -u # exit when undeclared variables exist set -x # trace what gets executed As a recommendation, use variables like: \"${var}\" to avoid problems with the names Send to background End commands with & to execute on background When the command is already running, use ctrl+z to turn it into zombie (in background but not executing) With jobs you can print already running processes With fg you can bring back zombies processes from background to foreground and they start executing, with bg you can let zombie processes execute in the background. Remember you can use kill -9 PID to kill a proccess To obtain the PID, use ps ax Use renice to adjust priority of processes for statement Example of a for statement, this example does something like ls for i in ./* ; do echo \"$i\" ; done Umask Use umask to temporarily change the default permissions Owner only read umask 277 Owner only read and write umask 177 Find Find is a very useful command to search files and execute commands on them. Find all .log files and delete them find /path/to/search -type f -name \"*.log\" -exec rm -f {} \\; VIM notes You can use regex expressions on vim, for example, to delete all comment lines: :g/^\\s*#/d You can invoke netrw which is kinda file explorer :Explore - opens netrw in the current window :Sexplore - opens netrw in a horizontal split :Vexplore - opens netrw in a vertical split You can also snigger by typing :Sex to invoke a horizontal split. How to copy paste on vim Position the cursor where you want to begin cutting. Press v to select characters, or uppercase V to select whole lines, or Ctrl-v to select rectangular blocks (use Ctrl-q if Ctrl-v is mapped to paste). Move the cursor to the end of what you want to cut. Press d to cut (or y to copy). Move to where you would like to paste. Press P to paste before the cursor, or p to paste after.","title":"CLI"},{"location":"cli/cli-notes/#command-line-use-notes","text":"","title":"Command line use notes"},{"location":"cli/cli-notes/#bash-notes","text":"For compatibility, use this as shebang on scripts: #!/usr/bin/env bash Temporarily disable the bash history set +o history Some useful parameters on scripts set -e # exit on error set -u # exit when undeclared variables exist set -x # trace what gets executed As a recommendation, use variables like: \"${var}\" to avoid problems with the names","title":"Bash notes"},{"location":"cli/cli-notes/#send-to-background","text":"End commands with & to execute on background When the command is already running, use ctrl+z to turn it into zombie (in background but not executing) With jobs you can print already running processes With fg you can bring back zombies processes from background to foreground and they start executing, with bg you can let zombie processes execute in the background. Remember you can use kill -9 PID to kill a proccess To obtain the PID, use ps ax Use renice to adjust priority of processes","title":"Send to background"},{"location":"cli/cli-notes/#for-statement","text":"Example of a for statement, this example does something like ls for i in ./* ; do echo \"$i\" ; done","title":"for statement"},{"location":"cli/cli-notes/#umask","text":"Use umask to temporarily change the default permissions Owner only read umask 277 Owner only read and write umask 177","title":"Umask"},{"location":"cli/cli-notes/#find","text":"Find is a very useful command to search files and execute commands on them. Find all .log files and delete them find /path/to/search -type f -name \"*.log\" -exec rm -f {} \\;","title":"Find"},{"location":"cli/cli-notes/#vim-notes","text":"You can use regex expressions on vim, for example, to delete all comment lines: :g/^\\s*#/d You can invoke netrw which is kinda file explorer :Explore - opens netrw in the current window :Sexplore - opens netrw in a horizontal split :Vexplore - opens netrw in a vertical split You can also snigger by typing :Sex to invoke a horizontal split.","title":"VIM notes"},{"location":"cli/cli-notes/#how-to-copy-paste-on-vim","text":"Position the cursor where you want to begin cutting. Press v to select characters, or uppercase V to select whole lines, or Ctrl-v to select rectangular blocks (use Ctrl-q if Ctrl-v is mapped to paste). Move the cursor to the end of what you want to cut. Press d to cut (or y to copy). Move to where you would like to paste. Press P to paste before the cursor, or p to paste after.","title":"How to copy paste on vim"},{"location":"containers/container-notes/","text":"Container notes Some useful commands and notes for container management with podman/docker. Managing containers Basic commands Listing containers: podman ps -a Deleting all containers: podman rm -a Deleting all container images: podman rmi -a Viewing logs with timestamps and follow: podman logs --tail 50 --follow --timestamps name-of-the-container Executing a command inside a running container: podman exec -it name-of-the-container bash Using quadlet Quadlet is the new way of managing containers with systemd. Basic quadlet example: [Container] Image=docker.io/library/postgres:16 AutoUpdate=registry PublishPort=5432:5432 Volume=%h/volumes/test-db:/var/lib/postgresql/data:Z Environment=POSTGRES_PASSWORD=CHANGE_ME [Service] Restart=always [Install] WantedBy=default.target Building images Building image in podman: podman build -t name:version . Building image in podman with docker format: podman build -t name:version --format docker . Tips and tricks Fast disposable container In some cases I need to test some command in a distro, the fastest way of doing this is through a podman container, you can change fedora for the distro of your choice. podman run -it --rm fedora bash Using a system with selinux and podman When mounting volumes use :z if multiple containers need access to the volume or :Z if only that contasner needs access. Example: podman run -it --rm -v ./thing/:/thing:z alpine sh or in a docker-compose.yml: - ./postgresdata:/var/lib/postgresql/data:z Extrating binaries from container This is useful for example for a raspberry, when you want to run software without containers but there is no oficial binaries for aarch64 released only precompiled container, you can extract the binary from a oficial container image. Read the Containerfile/Dockerfile first to know what are the dependencies Extracting binaries for Vaultwarden Pull the image for the architecture you want, be careful with tags Create but not start a container based on the image Copy the needed binaries Delete container and image podman pull --platform linux/arm64 vaultwarden/server podman create --name vw vaultwarden/server podman cp vw:/vaultwarden . podman cp vw:/web-vault . podman rm vw podman rmi vaultwarden/server:latest Ping from rootless container In case you want to be able to use ping inside rootless containers, you can run: echo -e 'net.ipv4.ping_group_range=0 165535' | sudo tee /etc/sysctl.d/podman-ping.conf Enable docker registry on podman In some distributions podman package it is not included the docker registry so if you want to use it, you must specify it in the configuration. mkdir -p $HOME/.config/containers/ echo -e \"[registries.search]\\nregistries = ['docker.io']\" | tee $HOME/.config/containers/registries.conf ``` ### Enable podman socket This is useful for using podman with tools that expect a docker socket like portainer or docker-compose. For a rootless user: ```sh systemctl --user enable --now podman.socket export DOCKER_HOST=///run/user/$UID/podman/podman.sock Problems with SELINUX I had a problem when using the linuxserver's swag image where the image could not make the needed chown. To solve it, I added this to the podman command. --security-opt label=disable","title":"Containers"},{"location":"containers/container-notes/#container-notes","text":"Some useful commands and notes for container management with podman/docker.","title":"Container notes"},{"location":"containers/container-notes/#managing-containers","text":"","title":"Managing containers"},{"location":"containers/container-notes/#basic-commands","text":"Listing containers: podman ps -a Deleting all containers: podman rm -a Deleting all container images: podman rmi -a Viewing logs with timestamps and follow: podman logs --tail 50 --follow --timestamps name-of-the-container Executing a command inside a running container: podman exec -it name-of-the-container bash","title":"Basic commands"},{"location":"containers/container-notes/#using-quadlet","text":"Quadlet is the new way of managing containers with systemd. Basic quadlet example: [Container] Image=docker.io/library/postgres:16 AutoUpdate=registry PublishPort=5432:5432 Volume=%h/volumes/test-db:/var/lib/postgresql/data:Z Environment=POSTGRES_PASSWORD=CHANGE_ME [Service] Restart=always [Install] WantedBy=default.target","title":"Using quadlet"},{"location":"containers/container-notes/#building-images","text":"Building image in podman: podman build -t name:version . Building image in podman with docker format: podman build -t name:version --format docker .","title":"Building images"},{"location":"containers/container-notes/#tips-and-tricks","text":"","title":"Tips and tricks"},{"location":"containers/container-notes/#fast-disposable-container","text":"In some cases I need to test some command in a distro, the fastest way of doing this is through a podman container, you can change fedora for the distro of your choice. podman run -it --rm fedora bash","title":"Fast disposable container"},{"location":"containers/container-notes/#using-a-system-with-selinux-and-podman","text":"When mounting volumes use :z if multiple containers need access to the volume or :Z if only that contasner needs access. Example: podman run -it --rm -v ./thing/:/thing:z alpine sh or in a docker-compose.yml: - ./postgresdata:/var/lib/postgresql/data:z","title":"Using a system with selinux and podman"},{"location":"containers/container-notes/#extrating-binaries-from-container","text":"This is useful for example for a raspberry, when you want to run software without containers but there is no oficial binaries for aarch64 released only precompiled container, you can extract the binary from a oficial container image. Read the Containerfile/Dockerfile first to know what are the dependencies","title":"Extrating binaries from container"},{"location":"containers/container-notes/#extracting-binaries-for-vaultwarden","text":"Pull the image for the architecture you want, be careful with tags Create but not start a container based on the image Copy the needed binaries Delete container and image podman pull --platform linux/arm64 vaultwarden/server podman create --name vw vaultwarden/server podman cp vw:/vaultwarden . podman cp vw:/web-vault . podman rm vw podman rmi vaultwarden/server:latest","title":"Extracting binaries for Vaultwarden"},{"location":"containers/container-notes/#ping-from-rootless-container","text":"In case you want to be able to use ping inside rootless containers, you can run: echo -e 'net.ipv4.ping_group_range=0 165535' | sudo tee /etc/sysctl.d/podman-ping.conf","title":"Ping from rootless container"},{"location":"containers/container-notes/#enable-docker-registry-on-podman","text":"In some distributions podman package it is not included the docker registry so if you want to use it, you must specify it in the configuration. mkdir -p $HOME/.config/containers/ echo -e \"[registries.search]\\nregistries = ['docker.io']\" | tee $HOME/.config/containers/registries.conf ``` ### Enable podman socket This is useful for using podman with tools that expect a docker socket like portainer or docker-compose. For a rootless user: ```sh systemctl --user enable --now podman.socket export DOCKER_HOST=///run/user/$UID/podman/podman.sock","title":"Enable docker registry on podman"},{"location":"containers/container-notes/#problems-with-selinux","text":"I had a problem when using the linuxserver's swag image where the image could not make the needed chown. To solve it, I added this to the podman command. --security-opt label=disable","title":"Problems with SELINUX"},{"location":"dns/dns-notes/","text":"DNS notes Dig utility Dig is a useful tool for querying DNS servers. Usage Basic query: dig example.com Query specific record type: dig example.com A dig example.com MX dig example.com TXT Query using a specific DNS server: dig @1.1.1.1 example.com Query with +short for concise output: dig example.com +short Unbound dns server Unbound is a validating, recursive, and caching DNS resolver. Basic configuration For a recursive dns server you need to be able to resolve from the root servers, for that you need the root hints file. Get root hints: wget -S -N https://www.internic.net/domain/named.cache -O /etc/unbound/root.hints # or with curl curl -fsSL -o /etc/unbound/root.hints https://www.internic.net/domain/named.cache You should have a cronjob running for this every month (as root)s Systemd-resolved configuration If you need to be able to bind port 53 with systemd-resolved enabled, you need to configure systemd-resolved to listen on another port besides 53, for example 5353, and then configure unbound or blocky Edit /etc/systemd/resolved.conf [Resolve] DNS=9.9.9.9 8.8.8.8 DNSStubListener=no Restart systemd-resolved sudo systemctl restart systemd-resolved","title":"Overview"},{"location":"dns/dns-notes/#dns-notes","text":"","title":"DNS notes"},{"location":"dns/dns-notes/#dig-utility","text":"Dig is a useful tool for querying DNS servers.","title":"Dig utility"},{"location":"dns/dns-notes/#usage","text":"Basic query: dig example.com Query specific record type: dig example.com A dig example.com MX dig example.com TXT Query using a specific DNS server: dig @1.1.1.1 example.com Query with +short for concise output: dig example.com +short","title":"Usage"},{"location":"dns/dns-notes/#unbound-dns-server","text":"Unbound is a validating, recursive, and caching DNS resolver.","title":"Unbound dns server"},{"location":"dns/dns-notes/#basic-configuration","text":"For a recursive dns server you need to be able to resolve from the root servers, for that you need the root hints file. Get root hints: wget -S -N https://www.internic.net/domain/named.cache -O /etc/unbound/root.hints # or with curl curl -fsSL -o /etc/unbound/root.hints https://www.internic.net/domain/named.cache You should have a cronjob running for this every month (as root)s","title":"Basic configuration"},{"location":"dns/dns-notes/#systemd-resolved-configuration","text":"If you need to be able to bind port 53 with systemd-resolved enabled, you need to configure systemd-resolved to listen on another port besides 53, for example 5353, and then configure unbound or blocky Edit /etc/systemd/resolved.conf [Resolve] DNS=9.9.9.9 8.8.8.8 DNSStubListener=no Restart systemd-resolved sudo systemctl restart systemd-resolved","title":"Systemd-resolved configuration"},{"location":"git/git-notes/","text":"Git notes Initial setup Creating ssh keys To use git with ssh, you need to create ssh keys. Here is how you can do it: # Generate a new ssh key ssh-keygen -o -a 100 -t ed25519 -f /path/to/key -C \"your@email.com\" # Change passphrase ssh-keygen -p -f /path/to/key Configuring git It is important to configure git before using it. Here are some basic configurations: # Configure name git config --global user.name \"Your Name\" # Configure email git config --global user.email \"your@email.com\" # Configure editor git config --global core.editor \"vim\" # Configure color git config --global color.ui auto Working with repositories Creating a repository To create a repository, you can either turn a directory into a git repository or clone a repository. # Turn a directory into a git repository git init # Clone a repository git clone <url> # Clone only the latest commit git clone --depth=1 <url> s## Staging files Git has a staging area where you can add files before committing them. # Add a file to the staging area git add <file> # Add all files to the staging area git add . # Remove a file from the staging area git reset <file> # Remove all files from the staging area git reset Committing changes After adding files to the staging area, you can commit them. This will create a snapshot of the repository at that point. # Commit changes git commit -m \"Message\" # Commit changes with a message on the editor git commit Checking the status You can check the status of the repository at any time. Which files are staged, which files are not, etc. # Check the status of the repository git status s## Syncing changes You can sync changes with a remote repository. This is useful when working with others. # Push changes to a remote repository git push <remote> <branch> # Force push changes to a remote repository git push -f <remote> <branch> # Pull changes from a remote repository git pull <remote> <branch> # Fetch changes from a remote repository git fetch <remote> # Merge changes from a remote repository git merge <remote>/<branch> Logging You can check the history of the repository at any time. # Show the history of the repository git log # Show differences between the working directory and the staging area git diff # Show differences between commits git diff <commit> <commit> # Show differences between the working directory and the last commit git diff HEAD Moving around You can move around the history of the repository. # Go to the last commit git checkout HEAD # Go to a specific commit git checkout <commit> # Go to the previous commit git checkout HEAD^ # Go to the next commit git checkout HEAD@{1} Reverting changes You can revert changes in the repository from a specific commit. # Reverse a commit git revert <commit> # Reset the repository to a previous commit git reset <commit> # Reset the repository to a previous commit and keep the changes git reset --soft <commit> # Reset the repository to a previous commit and discard the changes git reset --hard <commit> Stashing changes You can stash changes in the repository. This is useful when you want to work on something else. # Stash changes git stash # Apply stashed changes git stash apply # List stashed changes git stash list # Drop stashed changes git stash drop Branching Branching is a powerful feature of git. You can create branches to work on new features, bug fixes, etc. without affecting the main branch. # List branches git branch -a # Create a branch git branch <branch> # Switch to a branch git checkout <branch> # Create a branch and switch to it git checkout -b <branch> # Delete a branch git branch -d <branch> # Merge a branch git merge <branch>","title":"Git"},{"location":"git/git-notes/#git-notes","text":"","title":"Git notes"},{"location":"git/git-notes/#initial-setup","text":"","title":"Initial setup"},{"location":"git/git-notes/#creating-ssh-keys","text":"To use git with ssh, you need to create ssh keys. Here is how you can do it: # Generate a new ssh key ssh-keygen -o -a 100 -t ed25519 -f /path/to/key -C \"your@email.com\" # Change passphrase ssh-keygen -p -f /path/to/key","title":"Creating ssh keys"},{"location":"git/git-notes/#configuring-git","text":"It is important to configure git before using it. Here are some basic configurations: # Configure name git config --global user.name \"Your Name\" # Configure email git config --global user.email \"your@email.com\" # Configure editor git config --global core.editor \"vim\" # Configure color git config --global color.ui auto","title":"Configuring git"},{"location":"git/git-notes/#working-with-repositories","text":"","title":"Working with repositories"},{"location":"git/git-notes/#creating-a-repository","text":"To create a repository, you can either turn a directory into a git repository or clone a repository. # Turn a directory into a git repository git init # Clone a repository git clone <url> # Clone only the latest commit git clone --depth=1 <url> s## Staging files Git has a staging area where you can add files before committing them. # Add a file to the staging area git add <file> # Add all files to the staging area git add . # Remove a file from the staging area git reset <file> # Remove all files from the staging area git reset","title":"Creating a repository"},{"location":"git/git-notes/#committing-changes","text":"After adding files to the staging area, you can commit them. This will create a snapshot of the repository at that point. # Commit changes git commit -m \"Message\" # Commit changes with a message on the editor git commit","title":"Committing changes"},{"location":"git/git-notes/#checking-the-status","text":"You can check the status of the repository at any time. Which files are staged, which files are not, etc. # Check the status of the repository git status s## Syncing changes You can sync changes with a remote repository. This is useful when working with others. # Push changes to a remote repository git push <remote> <branch> # Force push changes to a remote repository git push -f <remote> <branch> # Pull changes from a remote repository git pull <remote> <branch> # Fetch changes from a remote repository git fetch <remote> # Merge changes from a remote repository git merge <remote>/<branch>","title":"Checking the status"},{"location":"git/git-notes/#logging","text":"You can check the history of the repository at any time. # Show the history of the repository git log # Show differences between the working directory and the staging area git diff # Show differences between commits git diff <commit> <commit> # Show differences between the working directory and the last commit git diff HEAD","title":"Logging"},{"location":"git/git-notes/#moving-around","text":"You can move around the history of the repository. # Go to the last commit git checkout HEAD # Go to a specific commit git checkout <commit> # Go to the previous commit git checkout HEAD^ # Go to the next commit git checkout HEAD@{1}","title":"Moving around"},{"location":"git/git-notes/#reverting-changes","text":"You can revert changes in the repository from a specific commit. # Reverse a commit git revert <commit> # Reset the repository to a previous commit git reset <commit> # Reset the repository to a previous commit and keep the changes git reset --soft <commit> # Reset the repository to a previous commit and discard the changes git reset --hard <commit>","title":"Reverting changes"},{"location":"git/git-notes/#stashing-changes","text":"You can stash changes in the repository. This is useful when you want to work on something else. # Stash changes git stash # Apply stashed changes git stash apply # List stashed changes git stash list # Drop stashed changes git stash drop","title":"Stashing changes"},{"location":"git/git-notes/#branching","text":"Branching is a powerful feature of git. You can create branches to work on new features, bug fixes, etc. without affecting the main branch. # List branches git branch -a # Create a branch git branch <branch> # Switch to a branch git checkout <branch> # Create a branch and switch to it git checkout -b <branch> # Delete a branch git branch -d <branch> # Merge a branch git merge <branch>","title":"Branching"},{"location":"network/cisco-notes/","text":"Cisco Notes Notes created from CCNA preparation material and personal experience with Cisco devices. 1. Access & Management Physical Connection (Console) You need a USB-to-serial adapter or a serial cable to connect to the console port of a Cisco device. Using screen: screen /dev/ttyUSB0 9600 Using minicom: minicom -D /dev/ttyUSB0 -b 9600 Using Telnet/SSH: telnet <ip_address> ssh -l <username> <ip_address> Enable Console Authentication configure terminal line console 0 login local exit exit Enable VTY (Virtual Terminal) Authentication configure terminal line vty 0 15 login local transport input telnet # If login local is not working transport input ssh # If login local is not working exit exit Configure SSH Server configure terminal ip domain-name <domain_name> crypto key generate rsa 1024 # Key size in bits aaa new-model ip ssh authentication-retries 3 ip ssh time-out 60 exit User & Password Management Create/Delete Users configure terminal username <username> password <password> # Plain text password username <username> secret <password> # MD5 hashed password no username <username> # Delete user exit Secure Passwords configure terminal enable secret <password> # Set privileged exec password service password-encryption # Encrypt all plain text passwords exit System Administration Global Setup enable configure terminal hostname <new_hostname> # Set the hostname no ip domain-lookup # Disable DNS lookup to prevent typos acting as domain lookups exit Saving Configuration write # or copy running-config startup-config Clock & NTP # Set the clock manually (Privileged EXEC) clock set HH:MM:SS DAY MONTH YEAR # Example: clock set 14:30:00 14 November 2025 # Configure NTP configure terminal ntp server <ip> # Sync time from this server ntp master # Act as authoritative time source exit # Verification show clock show ntp status show ntp associations Syslog Configuration configure terminal logging host <ip> logging trap <message_level> # Levels: 0=emerg, 1=alert, 2=crit, 3=err, 4=warn, 5=notif, 6=info, 7=debug # Add timestamps with millisecond precision service timestamps log datetime msec exit show logging 2. Interface Configuration IPv4 Configuration View Interfaces show ip interface brief Configure Router Interface configure terminal interface <interface_name> description <description> ip address <ip_address> <subnet_mask> no shutdown exit exit Configure Switch Interface (SVI) configure terminal interface vlan 1 description <description> ip address <ip_address> <subnet_mask> ip default-gateway <gateway_ip> no shutdown exit exit Remove IP Address configure terminal interface <interface_name> no ip address exit IPv6 Configuration Enable IPv6 Routing configure terminal ipv6 unicast-routing exit Configure Interface configure terminal interface <interface_name> ipv6 address <ipv6_address>/<prefix_length> no shutdown exit exit Configure Interface (EUI-64) configure terminal interface <interface_name> ipv6 address <ipv6_network>/<prefix_length> eui-64 no shutdown exit exit 3. Switching (Layer 2) VLANs & Trunking Basic Commands show vlan brief Create VLANs configure terminal vlan <vlan_id> name <vlan_name> exit Access Port configure terminal interface <interface_name> switchport mode access switchport access vlan <vlan_id> exit Range of Ports configure terminal interface range <interface_range> # e.g., fa0/3-4 switchport mode access switchport access vlan <vlan_id> exit Trunk Port configure terminal interface <interface_name> switchport mode trunk switchport trunk allowed vlan <vlan_list> # Optional e.g., 5,7 exit # Verify show interfaces trunk MAC Address Table show mac address-table clear mac address-table dynamic Spanning Tree Protocol (STP) Verification show spanning-tree show spanning-tree vlan <vlan_id> Root Bridge Configuration configure terminal # Primary Root (Subtracts 2 \u00d7 4096 from default priority) spanning-tree vlan <vlan_id> root primary # Secondary Root (Subtracts 1 \u00d7 4096 from default priority) spanning-tree vlan <vlan_id> root secondary # Manual Priority (Must be multiple of 4096) spanning-tree vlan <vlan_id> priority <priority_value> exit PortFast & BPDU Guard configure terminal interface fa0/10 spanning-tree portfast spanning-tree bpduguard enable exit exit EtherChannel (Port-Channel) Configuration Modes PAgP (Cisco): desirable (active) / auto (passive) LACP (Open): active / passive configure terminal interface range fa0/1-3 channel-group 1 mode <desirable/auto/active/passive> exit interface port-channel 1 switchport mode trunk exit exit # Verify show interface port-channel 1 show etherchannel summary Port Security configure terminal interface <interface_name> switchport mode access switchport port-security # Max MACs (default 1) switchport port-security maximum <number> # Violation mode (shutdown, protect, restrict) switchport port-security violation shutdown # Learn MACs dynamically (sticky) switchport port-security mac-address sticky exit exit # Verify show port-security interface <interface_name> # Reset interface after violation configure terminal interface <interface_name> shutdown no shutdown exit 4. Routing (Layer 3) Basic Routing Commands show ip route Static Routing Static Route configure terminal ip route <network> <mask> <next_hop_ip_or_interface> [AD] # Example: ip route 192.168.1.0 255.255.255.0 192.168.30.1 Default Static Route configure terminal ip route 0.0.0.0 0.0.0.0 <next_hop_ip> Inter-VLAN Routing Router-on-a-Stick (ROAS) configure terminal interface <interface_name>.<vlan_id> encapsulation dot1q <vlan_id> ip address <ip_address> <subnet_mask> exit # Don't forget to enable physical interface interface <interface_name> no shutdown exit exit Layer 3 Switch configure terminal ip routing # Enable routing globally # Routed Port (Physical L3 interface) interface <interface_name> no switchport ip address <ip_address> <subnet_mask> exit # SVI (Virtual L3 interface for VLAN) interface vlan <vlan_id> ip address <ip_address> <subnet_mask> exit # Trunk on switch side interface <interface_name> switchport trunk encapsulation dot1q switchport mode trunk exit exit RIPv2 configure terminal router rip version 2 network <network_address> default-information originate # Propagate default route exit exit OSPF Basic Configuration configure terminal router ospf 1 # Explicit ID (recommended) router-id 1.1.1.1 # Network advertisements network 192.168.1.0 0.0.0.255 area 0 network 192.168.2.0 0.0.0.255 area 1 exit # Loopback for stability interface loopback 1 ip address 192.168.3.1 255.255.255.255 exit exit # Verify show ip ospf neighbor show ip ospf database Virtual Link (Connecting OSPF Areas) configure terminal router ospf 1 # Frontier router (ABR) configuration area 1 virtual-link router_id_of_frontier_router exit exit #### Scenario: Multi-Router RIP Config (R1-R2-R3) Example corrected configs for a 3-router chain. ##### R1 (Edge 1) ```bash interface Fa0/0 ip address 192.168.1.254 255.255.255.0 interface Se0/0/0 ip address 192.168.2.1 255.255.255.0 router rip version 2 network 192.168.1.0 network 192.168.2.0 R2 (Middle) interface Se0/0/0 ip address 192.168.2.2 255.255.255.0 interface Se0/0/1 ip address 192.168.3.1 255.255.255.0 router rip version 2 network 192.168.2.0 network 192.168.3.0 R3 (Edge 2) interface Fa0/0 ip address 192.168.4.254 255.255.255.0 interface Se0/0/1 ip address 192.168.3.2 255.255.255.0 router rip version 2 network 192.168.3.0 network 192.168.4.0 5. Network Services DHCP (Dynamic Host Configuration Protocol) DHCP Server (Pool) configure terminal # Exclude addresses first ip dhcp excluded-address 192.168.1.1 192.168.1.10 ip dhcp pool <name> network <network_address> <subnet_mask> default-router <gateway_ip> dns-server <dns_server_ip> exit exit DHCP Client Used when the router interface needs to get an IP from an ISP/WAN. configure terminal interface Fa0/0 ip address dhcp no shutdown exit exit DHCP Helper (Relay) Forward DHCP broadcasts from LAN to a server on a different subnet. configure terminal interface Fa0/0 ip helper-address <dhcp_server_ip> exit exit DHCP Verification show ip dhcp binding clear ip dhcp binding <ip_address> DHCP Snooping (Security) Prevents rogue DHCP servers. Trusted ports = Uplinks/Servers. Untrusted = Clients. configure terminal ip dhcp snooping ip dhcp snooping vlan 1 # Trust uplink to legitimate DHCP server interface Fa0/0 ip dhcp snooping trust exit # Optional: Database for binding persistence # ip dhcp snooping database flash:dhcp_snoop.db exit # Verify show ip dhcp snooping show ip dhcp snooping binding NAT (Network Address Translation) Interface Roles interface <wan_interface> ip nat outside interface <lan_interface> ip nat inside PAT (Overload) # 1. Create ACL matching traffic to translate access-list 1 permit 192.168.1.0 0.0.0.255 # 2. Apply NAT Overload ip nat inside source list 1 interface <wan_interface> overload Verify NAT show ip nat translations show ip nat statistics ACLs (Access Control Lists) Standard ACL (1-99) Filters based on Source IP only. access-list 10 permit 192.168.1.0 0.0.0.255 access-list 10 deny host 10.1.1.1 Extended ACL (100-199) Filters based on Protocol, Source, Destination, and Port. access-list 100 permit tcp 192.168.1.0 0.0.0.255 host 10.1.1.5 eq 80 access-list 100 deny ip any any Apply to Interface interface <interface_name> ip access-group <acl_number> <in/out> Verify ACLs show access-lists HSRP (Redundancy) Active Router (Higher Priority) interface Fa0/0 standby 10 ip 192.168.1.100 standby 10 priority 200 standby 10 preempt Standby Router interface Fa0/0 standby 10 ip 192.168.1.100 standby 10 priority 100 Verify: show standby 6. Miscellaneous & Lab Tools Simple Python HTTP Server Serves files from the current directory. sudo python3 -m http.server 80 Dnsmasq (Simple DNS Server) no-resolv no-poll listen-address=127.0.0.1 listen-address=192.168.50.100 address=/cisco.com/192.168.50.225 Cisco Packet Tracer Servers Service Setup DNS: Create A records (IPs) and MX records (Email). Email: Enable SMTP/POP3, set domain, create users. HTTP: Edit index.html. FTP: Create users with permissions (R/W/D/L). FTP Client Commands (PC) ftp <server_ip> dir # List files put <filename> # Upload get <filename> # Download quit","title":"Cisco"},{"location":"network/cisco-notes/#cisco-notes","text":"Notes created from CCNA preparation material and personal experience with Cisco devices.","title":"Cisco Notes"},{"location":"network/cisco-notes/#1-access-management","text":"","title":"1. Access &amp; Management"},{"location":"network/cisco-notes/#physical-connection-console","text":"You need a USB-to-serial adapter or a serial cable to connect to the console port of a Cisco device. Using screen: screen /dev/ttyUSB0 9600 Using minicom: minicom -D /dev/ttyUSB0 -b 9600 Using Telnet/SSH: telnet <ip_address> ssh -l <username> <ip_address> Enable Console Authentication configure terminal line console 0 login local exit exit Enable VTY (Virtual Terminal) Authentication configure terminal line vty 0 15 login local transport input telnet # If login local is not working transport input ssh # If login local is not working exit exit Configure SSH Server configure terminal ip domain-name <domain_name> crypto key generate rsa 1024 # Key size in bits aaa new-model ip ssh authentication-retries 3 ip ssh time-out 60 exit","title":"Physical Connection (Console)"},{"location":"network/cisco-notes/#user-password-management","text":"Create/Delete Users configure terminal username <username> password <password> # Plain text password username <username> secret <password> # MD5 hashed password no username <username> # Delete user exit Secure Passwords configure terminal enable secret <password> # Set privileged exec password service password-encryption # Encrypt all plain text passwords exit","title":"User &amp; Password Management"},{"location":"network/cisco-notes/#system-administration","text":"","title":"System Administration"},{"location":"network/cisco-notes/#global-setup","text":"enable configure terminal hostname <new_hostname> # Set the hostname no ip domain-lookup # Disable DNS lookup to prevent typos acting as domain lookups exit","title":"Global Setup"},{"location":"network/cisco-notes/#saving-configuration","text":"write # or copy running-config startup-config","title":"Saving Configuration"},{"location":"network/cisco-notes/#clock-ntp","text":"# Set the clock manually (Privileged EXEC) clock set HH:MM:SS DAY MONTH YEAR # Example: clock set 14:30:00 14 November 2025 # Configure NTP configure terminal ntp server <ip> # Sync time from this server ntp master # Act as authoritative time source exit # Verification show clock show ntp status show ntp associations","title":"Clock &amp; NTP"},{"location":"network/cisco-notes/#syslog-configuration","text":"configure terminal logging host <ip> logging trap <message_level> # Levels: 0=emerg, 1=alert, 2=crit, 3=err, 4=warn, 5=notif, 6=info, 7=debug # Add timestamps with millisecond precision service timestamps log datetime msec exit show logging","title":"Syslog Configuration"},{"location":"network/cisco-notes/#2-interface-configuration","text":"","title":"2. Interface Configuration"},{"location":"network/cisco-notes/#ipv4-configuration","text":"","title":"IPv4 Configuration"},{"location":"network/cisco-notes/#view-interfaces","text":"show ip interface brief","title":"View Interfaces"},{"location":"network/cisco-notes/#configure-router-interface","text":"configure terminal interface <interface_name> description <description> ip address <ip_address> <subnet_mask> no shutdown exit exit","title":"Configure Router Interface"},{"location":"network/cisco-notes/#configure-switch-interface-svi","text":"configure terminal interface vlan 1 description <description> ip address <ip_address> <subnet_mask> ip default-gateway <gateway_ip> no shutdown exit exit","title":"Configure Switch Interface (SVI)"},{"location":"network/cisco-notes/#remove-ip-address","text":"configure terminal interface <interface_name> no ip address exit","title":"Remove IP Address"},{"location":"network/cisco-notes/#ipv6-configuration","text":"","title":"IPv6 Configuration"},{"location":"network/cisco-notes/#enable-ipv6-routing","text":"configure terminal ipv6 unicast-routing exit","title":"Enable IPv6 Routing"},{"location":"network/cisco-notes/#configure-interface","text":"configure terminal interface <interface_name> ipv6 address <ipv6_address>/<prefix_length> no shutdown exit exit","title":"Configure Interface"},{"location":"network/cisco-notes/#configure-interface-eui-64","text":"configure terminal interface <interface_name> ipv6 address <ipv6_network>/<prefix_length> eui-64 no shutdown exit exit","title":"Configure Interface (EUI-64)"},{"location":"network/cisco-notes/#3-switching-layer-2","text":"","title":"3. Switching (Layer 2)"},{"location":"network/cisco-notes/#vlans-trunking","text":"","title":"VLANs &amp; Trunking"},{"location":"network/cisco-notes/#basic-commands","text":"show vlan brief","title":"Basic Commands"},{"location":"network/cisco-notes/#create-vlans","text":"configure terminal vlan <vlan_id> name <vlan_name> exit","title":"Create VLANs"},{"location":"network/cisco-notes/#access-port","text":"configure terminal interface <interface_name> switchport mode access switchport access vlan <vlan_id> exit","title":"Access Port"},{"location":"network/cisco-notes/#range-of-ports","text":"configure terminal interface range <interface_range> # e.g., fa0/3-4 switchport mode access switchport access vlan <vlan_id> exit","title":"Range of Ports"},{"location":"network/cisco-notes/#trunk-port","text":"configure terminal interface <interface_name> switchport mode trunk switchport trunk allowed vlan <vlan_list> # Optional e.g., 5,7 exit # Verify show interfaces trunk","title":"Trunk Port"},{"location":"network/cisco-notes/#mac-address-table","text":"show mac address-table clear mac address-table dynamic","title":"MAC Address Table"},{"location":"network/cisco-notes/#spanning-tree-protocol-stp","text":"","title":"Spanning Tree Protocol (STP)"},{"location":"network/cisco-notes/#verification","text":"show spanning-tree show spanning-tree vlan <vlan_id>","title":"Verification"},{"location":"network/cisco-notes/#root-bridge-configuration","text":"configure terminal # Primary Root (Subtracts 2 \u00d7 4096 from default priority) spanning-tree vlan <vlan_id> root primary # Secondary Root (Subtracts 1 \u00d7 4096 from default priority) spanning-tree vlan <vlan_id> root secondary # Manual Priority (Must be multiple of 4096) spanning-tree vlan <vlan_id> priority <priority_value> exit","title":"Root Bridge Configuration"},{"location":"network/cisco-notes/#portfast-bpdu-guard","text":"configure terminal interface fa0/10 spanning-tree portfast spanning-tree bpduguard enable exit exit","title":"PortFast &amp; BPDU Guard"},{"location":"network/cisco-notes/#etherchannel-port-channel","text":"","title":"EtherChannel (Port-Channel)"},{"location":"network/cisco-notes/#configuration-modes","text":"PAgP (Cisco): desirable (active) / auto (passive) LACP (Open): active / passive configure terminal interface range fa0/1-3 channel-group 1 mode <desirable/auto/active/passive> exit interface port-channel 1 switchport mode trunk exit exit # Verify show interface port-channel 1 show etherchannel summary","title":"Configuration Modes"},{"location":"network/cisco-notes/#port-security","text":"configure terminal interface <interface_name> switchport mode access switchport port-security # Max MACs (default 1) switchport port-security maximum <number> # Violation mode (shutdown, protect, restrict) switchport port-security violation shutdown # Learn MACs dynamically (sticky) switchport port-security mac-address sticky exit exit # Verify show port-security interface <interface_name> # Reset interface after violation configure terminal interface <interface_name> shutdown no shutdown exit","title":"Port Security"},{"location":"network/cisco-notes/#4-routing-layer-3","text":"","title":"4. Routing (Layer 3)"},{"location":"network/cisco-notes/#basic-routing-commands","text":"show ip route","title":"Basic Routing Commands"},{"location":"network/cisco-notes/#static-routing","text":"","title":"Static Routing"},{"location":"network/cisco-notes/#static-route","text":"configure terminal ip route <network> <mask> <next_hop_ip_or_interface> [AD] # Example: ip route 192.168.1.0 255.255.255.0 192.168.30.1","title":"Static Route"},{"location":"network/cisco-notes/#default-static-route","text":"configure terminal ip route 0.0.0.0 0.0.0.0 <next_hop_ip>","title":"Default Static Route"},{"location":"network/cisco-notes/#inter-vlan-routing","text":"","title":"Inter-VLAN Routing"},{"location":"network/cisco-notes/#router-on-a-stick-roas","text":"configure terminal interface <interface_name>.<vlan_id> encapsulation dot1q <vlan_id> ip address <ip_address> <subnet_mask> exit # Don't forget to enable physical interface interface <interface_name> no shutdown exit exit","title":"Router-on-a-Stick (ROAS)"},{"location":"network/cisco-notes/#layer-3-switch","text":"configure terminal ip routing # Enable routing globally # Routed Port (Physical L3 interface) interface <interface_name> no switchport ip address <ip_address> <subnet_mask> exit # SVI (Virtual L3 interface for VLAN) interface vlan <vlan_id> ip address <ip_address> <subnet_mask> exit # Trunk on switch side interface <interface_name> switchport trunk encapsulation dot1q switchport mode trunk exit exit","title":"Layer 3 Switch"},{"location":"network/cisco-notes/#ripv2","text":"configure terminal router rip version 2 network <network_address> default-information originate # Propagate default route exit exit","title":"RIPv2"},{"location":"network/cisco-notes/#ospf","text":"","title":"OSPF"},{"location":"network/cisco-notes/#basic-configuration","text":"configure terminal router ospf 1 # Explicit ID (recommended) router-id 1.1.1.1 # Network advertisements network 192.168.1.0 0.0.0.255 area 0 network 192.168.2.0 0.0.0.255 area 1 exit # Loopback for stability interface loopback 1 ip address 192.168.3.1 255.255.255.255 exit exit # Verify show ip ospf neighbor show ip ospf database","title":"Basic Configuration"},{"location":"network/cisco-notes/#virtual-link-connecting-ospf-areas","text":"configure terminal router ospf 1 # Frontier router (ABR) configuration area 1 virtual-link router_id_of_frontier_router exit exit #### Scenario: Multi-Router RIP Config (R1-R2-R3) Example corrected configs for a 3-router chain. ##### R1 (Edge 1) ```bash interface Fa0/0 ip address 192.168.1.254 255.255.255.0 interface Se0/0/0 ip address 192.168.2.1 255.255.255.0 router rip version 2 network 192.168.1.0 network 192.168.2.0","title":"Virtual Link (Connecting OSPF Areas)"},{"location":"network/cisco-notes/#r2-middle","text":"interface Se0/0/0 ip address 192.168.2.2 255.255.255.0 interface Se0/0/1 ip address 192.168.3.1 255.255.255.0 router rip version 2 network 192.168.2.0 network 192.168.3.0","title":"R2 (Middle)"},{"location":"network/cisco-notes/#r3-edge-2","text":"interface Fa0/0 ip address 192.168.4.254 255.255.255.0 interface Se0/0/1 ip address 192.168.3.2 255.255.255.0 router rip version 2 network 192.168.3.0 network 192.168.4.0","title":"R3 (Edge 2)"},{"location":"network/cisco-notes/#5-network-services","text":"","title":"5. Network Services"},{"location":"network/cisco-notes/#dhcp-dynamic-host-configuration-protocol","text":"","title":"DHCP (Dynamic Host Configuration Protocol)"},{"location":"network/cisco-notes/#dhcp-server-pool","text":"configure terminal # Exclude addresses first ip dhcp excluded-address 192.168.1.1 192.168.1.10 ip dhcp pool <name> network <network_address> <subnet_mask> default-router <gateway_ip> dns-server <dns_server_ip> exit exit","title":"DHCP Server (Pool)"},{"location":"network/cisco-notes/#dhcp-client","text":"Used when the router interface needs to get an IP from an ISP/WAN. configure terminal interface Fa0/0 ip address dhcp no shutdown exit exit","title":"DHCP Client"},{"location":"network/cisco-notes/#dhcp-helper-relay","text":"Forward DHCP broadcasts from LAN to a server on a different subnet. configure terminal interface Fa0/0 ip helper-address <dhcp_server_ip> exit exit","title":"DHCP Helper (Relay)"},{"location":"network/cisco-notes/#dhcp-verification","text":"show ip dhcp binding clear ip dhcp binding <ip_address>","title":"DHCP Verification"},{"location":"network/cisco-notes/#dhcp-snooping-security","text":"Prevents rogue DHCP servers. Trusted ports = Uplinks/Servers. Untrusted = Clients. configure terminal ip dhcp snooping ip dhcp snooping vlan 1 # Trust uplink to legitimate DHCP server interface Fa0/0 ip dhcp snooping trust exit # Optional: Database for binding persistence # ip dhcp snooping database flash:dhcp_snoop.db exit # Verify show ip dhcp snooping show ip dhcp snooping binding","title":"DHCP Snooping (Security)"},{"location":"network/cisco-notes/#nat-network-address-translation","text":"","title":"NAT (Network Address Translation)"},{"location":"network/cisco-notes/#interface-roles","text":"interface <wan_interface> ip nat outside interface <lan_interface> ip nat inside","title":"Interface Roles"},{"location":"network/cisco-notes/#pat-overload","text":"# 1. Create ACL matching traffic to translate access-list 1 permit 192.168.1.0 0.0.0.255 # 2. Apply NAT Overload ip nat inside source list 1 interface <wan_interface> overload","title":"PAT (Overload)"},{"location":"network/cisco-notes/#verify-nat","text":"show ip nat translations show ip nat statistics","title":"Verify NAT"},{"location":"network/cisco-notes/#acls-access-control-lists","text":"","title":"ACLs (Access Control Lists)"},{"location":"network/cisco-notes/#standard-acl-1-99","text":"Filters based on Source IP only. access-list 10 permit 192.168.1.0 0.0.0.255 access-list 10 deny host 10.1.1.1","title":"Standard ACL (1-99)"},{"location":"network/cisco-notes/#extended-acl-100-199","text":"Filters based on Protocol, Source, Destination, and Port. access-list 100 permit tcp 192.168.1.0 0.0.0.255 host 10.1.1.5 eq 80 access-list 100 deny ip any any","title":"Extended ACL (100-199)"},{"location":"network/cisco-notes/#apply-to-interface","text":"interface <interface_name> ip access-group <acl_number> <in/out>","title":"Apply to Interface"},{"location":"network/cisco-notes/#verify-acls","text":"show access-lists","title":"Verify ACLs"},{"location":"network/cisco-notes/#hsrp-redundancy","text":"","title":"HSRP (Redundancy)"},{"location":"network/cisco-notes/#active-router-higher-priority","text":"interface Fa0/0 standby 10 ip 192.168.1.100 standby 10 priority 200 standby 10 preempt","title":"Active Router (Higher Priority)"},{"location":"network/cisco-notes/#standby-router","text":"interface Fa0/0 standby 10 ip 192.168.1.100 standby 10 priority 100 Verify: show standby","title":"Standby Router"},{"location":"network/cisco-notes/#6-miscellaneous-lab-tools","text":"","title":"6. Miscellaneous &amp; Lab Tools"},{"location":"network/cisco-notes/#simple-python-http-server","text":"Serves files from the current directory. sudo python3 -m http.server 80","title":"Simple Python HTTP Server"},{"location":"network/cisco-notes/#dnsmasq-simple-dns-server","text":"no-resolv no-poll listen-address=127.0.0.1 listen-address=192.168.50.100 address=/cisco.com/192.168.50.225","title":"Dnsmasq (Simple DNS Server)"},{"location":"network/cisco-notes/#cisco-packet-tracer-servers","text":"","title":"Cisco Packet Tracer Servers"},{"location":"network/cisco-notes/#service-setup","text":"DNS: Create A records (IPs) and MX records (Email). Email: Enable SMTP/POP3, set domain, create users. HTTP: Edit index.html. FTP: Create users with permissions (R/W/D/L).","title":"Service Setup"},{"location":"network/cisco-notes/#ftp-client-commands-pc","text":"ftp <server_ip> dir # List files put <filename> # Upload get <filename> # Download quit","title":"FTP Client Commands (PC)"},{"location":"network/networking-notes/","text":"Networking notes FirewallD FirewallD is a dynamic firewall management tool with support for network zones. Basic commands List zones: firewall-cmd --get-zones Get active zones: firewall-cmd --get-active-zones Add service to zone: firewall-cmd --zone=<zone> --add-service=<service> --permanent firewall-cmd --reload Add port to zone: firewall-cmd --zone=<zone> --add-port=<port>/tcp --permanent firewall-cmd --reload Remove service from zone: firewall-cmd --zone=<zone> --remove-service=<service> --permanent firewall-cmd --reload Remove port from zone: firewall-cmd --zone=<zone> --remove-port=<port>/tcp --permanent firewall-cmd --reload List services in zone: firewall-cmd --zone=<zone> --list-all Add a source to a zone: firewall-cmd --zone=<zone> --add-source=<source_ip_or_network> --permanent firewall-cmd --reload Remove a source from a zone: firewall-cmd --zone=<zone> --remove-source=<source_ip_or_network> --permanent firewall-cmd --reload Firewalld geoblocking If you only need your service in a certain country it is a good idea to block everything except the working zone, to do it: Download the aggregated ips of the countries you need from https://www.ipdeny.com/ipblocks/ Create an ipset containing all the IPS sh firewall-cmd --permanent --new-ipset=IPs --type=hash:net firewall-cmd --permanent --ipset=IPs --add-entries-from-file=1.zone firewall-cmd --permanent --ipset=IPs --add-entries-from-file=2.zone Create a zone with rules for the allowed countries sh firewall-cmd --permanent --new-zone=MYZONE firewall-cmd --permanent --zone=MYZONE --add-source=ipset:IPs firewall-cmd --permanent --zone=MYZONE --add-service=ssh firewall-cmd --permanent --zone=MYZONE --add-port=80/tcp firewall-cmd --reload (Optional) If you dont want to allow anthing else you should drop everything by default. REMEMBER TO KEEP SSH ACCESS sh firewall-cmd --permanent --zone=public --set-target=DROP Keep in mind this has CPU/RAM usage implications depending on the amount of IPs you are blocking/allowing. Multithreading on network interfaces I hit a situation where I noticed that my server with multiple cores was not using all of them to handle network traffic. After some research I found out that enabling multiqueue on the network interface would help with that. Check that your hardware supports it (I recommend intel cards with RSS (Receive Side Scaling)) ethtool -i <interface> Install and start irqbalance , this service will help distribute the interrupts across all the cores. Optimize sysctl settings for better network performance by adding the following lines to /etc/sysctl.d/99-server-tuning.conf : #/etc/sysctl.d/99-server-tuning.conf # Increase the backlog of connections waiting to be accepted # (Helps prevents timeouts during traffic spikes) net.core.netdev_max_backlog = 5000 net.core.somaxconn = 4096 # Enable TCP BBR Congestion Control # (Much better at handling the variable speeds of mirror downloads) net.core.default_qdisc = fq net.ipv4.tcp_congestion_control = bbr # reuse timewait sockets (helps with Tor's many connections) net.ipv4.tcp_tw_reuse = 1","title":"Overview"},{"location":"network/networking-notes/#networking-notes","text":"","title":"Networking notes"},{"location":"network/networking-notes/#firewalld","text":"FirewallD is a dynamic firewall management tool with support for network zones.","title":"FirewallD"},{"location":"network/networking-notes/#basic-commands","text":"List zones: firewall-cmd --get-zones Get active zones: firewall-cmd --get-active-zones Add service to zone: firewall-cmd --zone=<zone> --add-service=<service> --permanent firewall-cmd --reload Add port to zone: firewall-cmd --zone=<zone> --add-port=<port>/tcp --permanent firewall-cmd --reload Remove service from zone: firewall-cmd --zone=<zone> --remove-service=<service> --permanent firewall-cmd --reload Remove port from zone: firewall-cmd --zone=<zone> --remove-port=<port>/tcp --permanent firewall-cmd --reload List services in zone: firewall-cmd --zone=<zone> --list-all Add a source to a zone: firewall-cmd --zone=<zone> --add-source=<source_ip_or_network> --permanent firewall-cmd --reload Remove a source from a zone: firewall-cmd --zone=<zone> --remove-source=<source_ip_or_network> --permanent firewall-cmd --reload","title":"Basic commands"},{"location":"network/networking-notes/#firewalld-geoblocking","text":"If you only need your service in a certain country it is a good idea to block everything except the working zone, to do it: Download the aggregated ips of the countries you need from https://www.ipdeny.com/ipblocks/ Create an ipset containing all the IPS sh firewall-cmd --permanent --new-ipset=IPs --type=hash:net firewall-cmd --permanent --ipset=IPs --add-entries-from-file=1.zone firewall-cmd --permanent --ipset=IPs --add-entries-from-file=2.zone Create a zone with rules for the allowed countries sh firewall-cmd --permanent --new-zone=MYZONE firewall-cmd --permanent --zone=MYZONE --add-source=ipset:IPs firewall-cmd --permanent --zone=MYZONE --add-service=ssh firewall-cmd --permanent --zone=MYZONE --add-port=80/tcp firewall-cmd --reload (Optional) If you dont want to allow anthing else you should drop everything by default. REMEMBER TO KEEP SSH ACCESS sh firewall-cmd --permanent --zone=public --set-target=DROP Keep in mind this has CPU/RAM usage implications depending on the amount of IPs you are blocking/allowing.","title":"Firewalld geoblocking"},{"location":"network/networking-notes/#multithreading-on-network-interfaces","text":"I hit a situation where I noticed that my server with multiple cores was not using all of them to handle network traffic. After some research I found out that enabling multiqueue on the network interface would help with that. Check that your hardware supports it (I recommend intel cards with RSS (Receive Side Scaling)) ethtool -i <interface> Install and start irqbalance , this service will help distribute the interrupts across all the cores. Optimize sysctl settings for better network performance by adding the following lines to /etc/sysctl.d/99-server-tuning.conf : #/etc/sysctl.d/99-server-tuning.conf # Increase the backlog of connections waiting to be accepted # (Helps prevents timeouts during traffic spikes) net.core.netdev_max_backlog = 5000 net.core.somaxconn = 4096 # Enable TCP BBR Congestion Control # (Much better at handling the variable speeds of mirror downloads) net.core.default_qdisc = fq net.ipv4.tcp_congestion_control = bbr # reuse timewait sockets (helps with Tor's many connections) net.ipv4.tcp_tw_reuse = 1","title":"Multithreading on network interfaces"},{"location":"sysadmin/databases-notes/","text":"Databases notes Managing Databases with Docker When using databases within Docker containers, it's essential to manage data persistence and backups effectively. Get an sql prompt inside a running container For MySQL/MariaDB: docker exec -it container_name mysql -u root -p docker exec -it container_name mariadb -u root -p Tips and Tricks Cleaning Largest Tables In order to identify the largest tables in your database, you can use the following SQL query: SELECT table_schema as `Database`, table_name AS `Table`, round(((data_length + index_length) / 1024 / 1024), 2) `Size in MB` FROM information_schema.TABLES ORDER BY (data_length + index_length) DESC; Create a stored procedure to clean old logs from a specific table ( tabName in this example) in batches to avoid long locks: USE database_name; -- Get it with show databases; DELIMITER $$ CREATE OR REPLACE PROCEDURE clean_old_logs() BEGIN DECLARE rows_affected INT DEFAULT 1; WHILE rows_affected > 0 DO DELETE FROM `tabName` WHERE creation < NOW() - INTERVAL 3 DAY LIMIT 500; SET rows_affected = ROW_COUNT(); END WHILE; END$$ DELIMITER ; CALL clean_old_logs(); Optimize the table you need after cleaning: OPTIMIZE TABLE `tabName`;","title":"Databases"},{"location":"sysadmin/databases-notes/#databases-notes","text":"","title":"Databases notes"},{"location":"sysadmin/databases-notes/#managing-databases-with-docker","text":"When using databases within Docker containers, it's essential to manage data persistence and backups effectively.","title":"Managing Databases with Docker"},{"location":"sysadmin/databases-notes/#get-an-sql-prompt-inside-a-running-container","text":"For MySQL/MariaDB: docker exec -it container_name mysql -u root -p docker exec -it container_name mariadb -u root -p","title":"Get an sql prompt inside a running container"},{"location":"sysadmin/databases-notes/#tips-and-tricks","text":"","title":"Tips and Tricks"},{"location":"sysadmin/databases-notes/#cleaning-largest-tables","text":"In order to identify the largest tables in your database, you can use the following SQL query: SELECT table_schema as `Database`, table_name AS `Table`, round(((data_length + index_length) / 1024 / 1024), 2) `Size in MB` FROM information_schema.TABLES ORDER BY (data_length + index_length) DESC; Create a stored procedure to clean old logs from a specific table ( tabName in this example) in batches to avoid long locks: USE database_name; -- Get it with show databases; DELIMITER $$ CREATE OR REPLACE PROCEDURE clean_old_logs() BEGIN DECLARE rows_affected INT DEFAULT 1; WHILE rows_affected > 0 DO DELETE FROM `tabName` WHERE creation < NOW() - INTERVAL 3 DAY LIMIT 500; SET rows_affected = ROW_COUNT(); END WHILE; END$$ DELIMITER ; CALL clean_old_logs(); Optimize the table you need after cleaning: OPTIMIZE TABLE `tabName`;","title":"Cleaning Largest Tables"},{"location":"sysadmin/erpnext-notes/","text":"Erpnext notes I mainly use the Docker installation of ERPNext, so these notes are focused on that setup. General commands for Frappe/ERPNext with Docker Get a python prompt inside a running container sudo docker exec -it container_name_backend bench --site frontend console When updating If the image is updated, the database needs to be migrated. sudo docker exec -it container_name_backend bench --site frontend migrate When frontend is not loading properly sudo docker exec -it container_name_backend bench --site frontend clear-cache sudo docker exec -it container_name_backend bench --site frontend clear-website-cache sudo docker exec -it container_name_redis_queue redis-cli flushall sudo docker exec -it container_name_redis_cache redis-cli flushall Change variant template Sometimes in ERPNext, an item variant may be incorrectly linked to the wrong template. The following Python scripts can be used within the Frappe framework to correct this issue. If the item has no links: def update_variant_template(variant_to_fix, correct_template): # Fetch the variant document doc = frappe.get_doc(\"Item\", variant_to_fix) # Update the variant_of field doc.variant_of = correct_template # Save the changes doc.save() # Commit to apply changes to the database frappe.db.commit() print(f\"Updated Item {variant_to_fix}: Now a variant of {correct_template}\") If the item has links and cannot be changed directly: def clone_variant_fix_template(old_variant, correct_template): # Fetch existing variant old_doc = frappe.get_doc(\"Item\", old_variant) # Generate a new unique item code new_item_code = make_autoname(f\"{old_variant}-.#####\") # Create a new variant with the correct template new_doc = frappe.copy_doc(old_doc) new_doc.variant_of = correct_template new_doc.item_code = new_item_code # Assign a unique item code new_doc.insert() # Deactivate old variant to prevent further usage old_doc.disabled = 1 old_doc.save() # Commit to apply changes to the database frappe.db.commit() print(f\"Created new variant {new_doc.name} ({new_item_code}) under {correct_template} and disabled {old_variant}.\") Example usage: # Update a single variant update_variant_template(\"variant_code\", \"template_code\") # Clone a variant and fix the template clone_variant_fix_template(\"variant_code\", \"template_code\")","title":"ERPNext"},{"location":"sysadmin/erpnext-notes/#erpnext-notes","text":"I mainly use the Docker installation of ERPNext, so these notes are focused on that setup.","title":"Erpnext notes"},{"location":"sysadmin/erpnext-notes/#general-commands-for-frappeerpnext-with-docker","text":"","title":"General commands for Frappe/ERPNext with Docker"},{"location":"sysadmin/erpnext-notes/#get-a-python-prompt-inside-a-running-container","text":"sudo docker exec -it container_name_backend bench --site frontend console","title":"Get a python prompt inside a running container"},{"location":"sysadmin/erpnext-notes/#when-updating","text":"If the image is updated, the database needs to be migrated. sudo docker exec -it container_name_backend bench --site frontend migrate","title":"When updating"},{"location":"sysadmin/erpnext-notes/#when-frontend-is-not-loading-properly","text":"sudo docker exec -it container_name_backend bench --site frontend clear-cache sudo docker exec -it container_name_backend bench --site frontend clear-website-cache sudo docker exec -it container_name_redis_queue redis-cli flushall sudo docker exec -it container_name_redis_cache redis-cli flushall","title":"When frontend is not loading properly"},{"location":"sysadmin/erpnext-notes/#change-variant-template","text":"Sometimes in ERPNext, an item variant may be incorrectly linked to the wrong template. The following Python scripts can be used within the Frappe framework to correct this issue. If the item has no links: def update_variant_template(variant_to_fix, correct_template): # Fetch the variant document doc = frappe.get_doc(\"Item\", variant_to_fix) # Update the variant_of field doc.variant_of = correct_template # Save the changes doc.save() # Commit to apply changes to the database frappe.db.commit() print(f\"Updated Item {variant_to_fix}: Now a variant of {correct_template}\") If the item has links and cannot be changed directly: def clone_variant_fix_template(old_variant, correct_template): # Fetch existing variant old_doc = frappe.get_doc(\"Item\", old_variant) # Generate a new unique item code new_item_code = make_autoname(f\"{old_variant}-.#####\") # Create a new variant with the correct template new_doc = frappe.copy_doc(old_doc) new_doc.variant_of = correct_template new_doc.item_code = new_item_code # Assign a unique item code new_doc.insert() # Deactivate old variant to prevent further usage old_doc.disabled = 1 old_doc.save() # Commit to apply changes to the database frappe.db.commit() print(f\"Created new variant {new_doc.name} ({new_item_code}) under {correct_template} and disabled {old_variant}.\") Example usage: # Update a single variant update_variant_template(\"variant_code\", \"template_code\") # Clone a variant and fix the template clone_variant_fix_template(\"variant_code\", \"template_code\")","title":"Change variant template"},{"location":"sysadmin/selinux-notes/","text":"Selinux notes Troubleshooting Allowing a service to bind to a port If you have a service that needs to bind to a port that is restricted by selinux, you can allow it with the following command: sudo semanage port -a -t <type> -p <protocol> <port> Examples: HTTP sudo semanage port -a -t http_port_t -p tcp 8080 DNS sudo semanage port -a -t dns_port_t -p tcp 5353 sudo semanage port -a -t dns_port_t -p udp 5353 SSH sudo semanage port -a -t ssh_port_t -p tcp 2222 Restore SELINUX context You can change the SELINUX context to the default of the directory it is located with sudo restorecon -R file Or you you can fix owner, group and selinux context if it was a path created from a rpm package. sudo rpm --restore -f /var/lib/path SELINUX ssh keys on non /home path If you use sudo audit2allow -w -a and see something like this: avc: denied { read } for pid=13996 comm=\"sshd\" name=\"authorized_keys\" dev=\"dm-0\" i \"sshd\" was denied read on a file resource named \"authorized_keys\". scontext=system_u:system_r:sshd_t:s0-s0:c0.c1023 SELinux context of the sshd process that attempted the denied action. tcontext=system_u:object_r:admin_home_t:s0 tclass=file SELinux context of the authorized_keys file. Use: semanage fcontext --add -t ssh_home_t \"/path/to/my/.ssh(/.*)?\" restorecon -FRv /path/to/my/.ssh Racknerd SELINUX Racknerd and other VPS providers with RHEL based images do not have SELINUX enabled. To enable SELINUX do the following steps: Enable NetworkManager systemctl enable NetworkManager Update dnf update --allowerasing dnf install vim selinux-policy-targeted selinux-policy-devel policycoreutils Autolabel all files touch /.autorelabel Set SELINUX as permissive for autolabel and reboot vim /etc/selinux/config reboot Check status and set enforcing sestatus vim /etc/selinux/config Now you can setup the new user, config ssh, automatic updates, etc.","title":"SELinux"},{"location":"sysadmin/selinux-notes/#selinux-notes","text":"","title":"Selinux notes"},{"location":"sysadmin/selinux-notes/#troubleshooting","text":"","title":"Troubleshooting"},{"location":"sysadmin/selinux-notes/#allowing-a-service-to-bind-to-a-port","text":"If you have a service that needs to bind to a port that is restricted by selinux, you can allow it with the following command: sudo semanage port -a -t <type> -p <protocol> <port> Examples: HTTP sudo semanage port -a -t http_port_t -p tcp 8080 DNS sudo semanage port -a -t dns_port_t -p tcp 5353 sudo semanage port -a -t dns_port_t -p udp 5353 SSH sudo semanage port -a -t ssh_port_t -p tcp 2222","title":"Allowing a service to bind to a port"},{"location":"sysadmin/selinux-notes/#restore-selinux-context","text":"You can change the SELINUX context to the default of the directory it is located with sudo restorecon -R file Or you you can fix owner, group and selinux context if it was a path created from a rpm package. sudo rpm --restore -f /var/lib/path","title":"Restore SELINUX context"},{"location":"sysadmin/selinux-notes/#selinux-ssh-keys-on-non-home-path","text":"If you use sudo audit2allow -w -a and see something like this: avc: denied { read } for pid=13996 comm=\"sshd\" name=\"authorized_keys\" dev=\"dm-0\" i \"sshd\" was denied read on a file resource named \"authorized_keys\". scontext=system_u:system_r:sshd_t:s0-s0:c0.c1023 SELinux context of the sshd process that attempted the denied action. tcontext=system_u:object_r:admin_home_t:s0 tclass=file SELinux context of the authorized_keys file. Use: semanage fcontext --add -t ssh_home_t \"/path/to/my/.ssh(/.*)?\" restorecon -FRv /path/to/my/.ssh","title":"SELINUX ssh keys on non /home path"},{"location":"sysadmin/selinux-notes/#racknerd-selinux","text":"Racknerd and other VPS providers with RHEL based images do not have SELINUX enabled. To enable SELINUX do the following steps: Enable NetworkManager systemctl enable NetworkManager Update dnf update --allowerasing dnf install vim selinux-policy-targeted selinux-policy-devel policycoreutils Autolabel all files touch /.autorelabel Set SELINUX as permissive for autolabel and reboot vim /etc/selinux/config reboot Check status and set enforcing sestatus vim /etc/selinux/config Now you can setup the new user, config ssh, automatic updates, etc.","title":"Racknerd SELINUX"},{"location":"sysadmin/sysadmin-notes/","text":"Sysadmin notes List for basic setup [ ] Add ssh key [ ] Configure ssh [ ] Enable a firewall [ ] Enable zram [ ] Configure automatic security updates [ ] Setup hostname and timezone [ ] If ssd you may enable /tmp on tmpfs Tips and tricks Add user to use as a service When you run a service, you should consider using a different user in order to not run as root or as a user with access to private information. This user does not has shell access and the home is usually where the aplication is stored. # No storage needed sudo adduser --home /var/empty/service --system --shell /sbin/nologin service # Persistent storage needed sudo adduser --home /var/lib/service --system --shell /sbin/nologin service Change permission When you want to change permissions on a recursive way, when you come across directories you got to be careful because they need to have executable permissions in order to be able to explore them, but you may not want to give this permissions to the files. So we use this for directories find /dir -type d -exec chmod 755 {} \\; # Readonly find /dir -type d -exec chmod 500 {} \\; And use this for files find /dir -type f -exec chmod 644 {} \\; # Read only find /dir -type f -exec chmod 400 {} \\; Wireguard For setting up a wireguard server, you need a compatible kernel and the wireguard tools, the wireguard config you can build it yourself using this just remember that if you need forwarding packets, you should allow it in your firewall, in firewalld: firewall-cmd --add-forward firewall-cmd --add-masquerade And to add to your /etc/sysctl.conf net.ipv4.ip_forward=1 net.ipv6.conf.all.forwarding=1 Smartmontools Commands Show all info sudo smartctl -a /dev/sdX Run a short test sudo smartctl -t short /dev/sdX Run a long test sudo smartctl -t long /dev/sdX Understanding SMART attributes Some notes of the meaning of each smart attribute, this just apply to mechanical disks ATTRIBUTE_NAME Meaning Best value G-SENSE RATE Impacts detected when the disk was powered on Lower better REALOCATE SECTOR COUNTS The name Normal to have a few CURRENT PENDING SECTOR Bad shutdown 1 can be fixed OFFLINE UNCORRECTABLE Failed sector More than 0 and the disk is diying ULTRA DMA CRC ERROR Problem with the wire or controller Lower better LOAD CYCLE COUNT Head stopped for inativity Less than 150K LOAD RETRY COUNT Head retrying enter the disk Lower better Disks Luks To open a luks encrypted disk cryptsetup open /dev/sdX name Encrypt a disk with luks cryptsetup --cipher aes-xts-plain64 --key-size 512 --hash sha512 --iter-time 5000 --use-urandom luksFormat /dev/sdXn Header backup cryptsetup luksHeaderBackup --header-backup-file /root/sdXn.header.bak /dev/sdXn Safetely remove a SATA disk from a running system Unmount any filesystems on the disk. ( umount ... ) Deactivate any LVM groups. ( vgchange -an ) Make sure nothing is using the disk for anything. Spin the HDD down. (irrelevant for SSD's) ( hdparm -Y /dev/sdX ) Tell the system, that we are unplugging the HDD. ( echo 1 | sudo tee /sys/block/sdX/device/delete","title":"Overview"},{"location":"sysadmin/sysadmin-notes/#sysadmin-notes","text":"","title":"Sysadmin notes"},{"location":"sysadmin/sysadmin-notes/#list-for-basic-setup","text":"[ ] Add ssh key [ ] Configure ssh [ ] Enable a firewall [ ] Enable zram [ ] Configure automatic security updates [ ] Setup hostname and timezone [ ] If ssd you may enable /tmp on tmpfs","title":"List for basic setup"},{"location":"sysadmin/sysadmin-notes/#tips-and-tricks","text":"","title":"Tips and tricks"},{"location":"sysadmin/sysadmin-notes/#add-user-to-use-as-a-service","text":"When you run a service, you should consider using a different user in order to not run as root or as a user with access to private information. This user does not has shell access and the home is usually where the aplication is stored. # No storage needed sudo adduser --home /var/empty/service --system --shell /sbin/nologin service # Persistent storage needed sudo adduser --home /var/lib/service --system --shell /sbin/nologin service","title":"Add user to use as a service"},{"location":"sysadmin/sysadmin-notes/#change-permission","text":"When you want to change permissions on a recursive way, when you come across directories you got to be careful because they need to have executable permissions in order to be able to explore them, but you may not want to give this permissions to the files. So we use this for directories find /dir -type d -exec chmod 755 {} \\; # Readonly find /dir -type d -exec chmod 500 {} \\; And use this for files find /dir -type f -exec chmod 644 {} \\; # Read only find /dir -type f -exec chmod 400 {} \\;","title":"Change permission"},{"location":"sysadmin/sysadmin-notes/#wireguard","text":"For setting up a wireguard server, you need a compatible kernel and the wireguard tools, the wireguard config you can build it yourself using this just remember that if you need forwarding packets, you should allow it in your firewall, in firewalld: firewall-cmd --add-forward firewall-cmd --add-masquerade And to add to your /etc/sysctl.conf net.ipv4.ip_forward=1 net.ipv6.conf.all.forwarding=1","title":"Wireguard"},{"location":"sysadmin/sysadmin-notes/#smartmontools","text":"","title":"Smartmontools"},{"location":"sysadmin/sysadmin-notes/#commands","text":"Show all info sudo smartctl -a /dev/sdX Run a short test sudo smartctl -t short /dev/sdX Run a long test sudo smartctl -t long /dev/sdX","title":"Commands"},{"location":"sysadmin/sysadmin-notes/#understanding-smart-attributes","text":"Some notes of the meaning of each smart attribute, this just apply to mechanical disks ATTRIBUTE_NAME Meaning Best value G-SENSE RATE Impacts detected when the disk was powered on Lower better REALOCATE SECTOR COUNTS The name Normal to have a few CURRENT PENDING SECTOR Bad shutdown 1 can be fixed OFFLINE UNCORRECTABLE Failed sector More than 0 and the disk is diying ULTRA DMA CRC ERROR Problem with the wire or controller Lower better LOAD CYCLE COUNT Head stopped for inativity Less than 150K LOAD RETRY COUNT Head retrying enter the disk Lower better","title":"Understanding SMART attributes"},{"location":"sysadmin/sysadmin-notes/#disks","text":"","title":"Disks"},{"location":"sysadmin/sysadmin-notes/#luks","text":"To open a luks encrypted disk cryptsetup open /dev/sdX name Encrypt a disk with luks cryptsetup --cipher aes-xts-plain64 --key-size 512 --hash sha512 --iter-time 5000 --use-urandom luksFormat /dev/sdXn Header backup cryptsetup luksHeaderBackup --header-backup-file /root/sdXn.header.bak /dev/sdXn","title":"Luks"},{"location":"sysadmin/sysadmin-notes/#safetely-remove-a-sata-disk-from-a-running-system","text":"Unmount any filesystems on the disk. ( umount ... ) Deactivate any LVM groups. ( vgchange -an ) Make sure nothing is using the disk for anything. Spin the HDD down. (irrelevant for SSD's) ( hdparm -Y /dev/sdX ) Tell the system, that we are unplugging the HDD. ( echo 1 | sudo tee /sys/block/sdX/device/delete","title":"Safetely remove a SATA disk from a running system"},{"location":"sysadmin/wordpress-notes/","text":"Wordpress Notes This document contains various notes and configurations related to managing and maintaining WordPress installations. Migration When migrating a WordPress site from one server to another, consider the following steps: Backup Files and Database : Ensure you have a complete backup of your WordPress files and database. The files to back up include the entire WordPress directory, typically located at /var/www/html/your-site . The database can be backed up using tools like mysqldump mysqldump -u username -p database_name > backup.sql Transfer Files : Use rsync or scp to transfer the WordPress files to the new server. rsync -avz /path/to/wordpress/ user@newserver:/path/to/destination/ Import Database : On the new server, create a new database and import the backup. mysql -u username -p new_database_name < backup.sql Update wp-config.php : Modify the wp-config.php file on the new server to reflect the new database credentials. Update Site URL : If the domain name has changed, update the site URL in the database. You can do this using wp-cli: # Migrate http to https docker run --rm --volumes-from wp-container --network container:wp-container wordpress:cli search-replace 'http://original.domain' 'https://new.domain' # Migrate https to https docker run --rm --volumes-from wp-container --network container:wp-container wordpress:cli search-replace 'https://original.domain' 'https://new.domain' # Migrate any remaining references docker run --rm --volumes-from wp-container --network container:wp-container wordpress:cli search-replace 'original.domain' 'new.domain' # Flush cache docker run --rm --volumes-from wp-container --network container:wp-container wordpress:cli cache flush Remember to recreate any cache of the extensions you are using.","title":"WordPress"},{"location":"sysadmin/wordpress-notes/#wordpress-notes","text":"This document contains various notes and configurations related to managing and maintaining WordPress installations.","title":"Wordpress Notes"},{"location":"sysadmin/wordpress-notes/#migration","text":"When migrating a WordPress site from one server to another, consider the following steps: Backup Files and Database : Ensure you have a complete backup of your WordPress files and database. The files to back up include the entire WordPress directory, typically located at /var/www/html/your-site . The database can be backed up using tools like mysqldump mysqldump -u username -p database_name > backup.sql Transfer Files : Use rsync or scp to transfer the WordPress files to the new server. rsync -avz /path/to/wordpress/ user@newserver:/path/to/destination/ Import Database : On the new server, create a new database and import the backup. mysql -u username -p new_database_name < backup.sql Update wp-config.php : Modify the wp-config.php file on the new server to reflect the new database credentials. Update Site URL : If the domain name has changed, update the site URL in the database. You can do this using wp-cli: # Migrate http to https docker run --rm --volumes-from wp-container --network container:wp-container wordpress:cli search-replace 'http://original.domain' 'https://new.domain' # Migrate https to https docker run --rm --volumes-from wp-container --network container:wp-container wordpress:cli search-replace 'https://original.domain' 'https://new.domain' # Migrate any remaining references docker run --rm --volumes-from wp-container --network container:wp-container wordpress:cli search-replace 'original.domain' 'new.domain' # Flush cache docker run --rm --volumes-from wp-container --network container:wp-container wordpress:cli cache flush Remember to recreate any cache of the extensions you are using.","title":"Migration"},{"location":"sysadmin/fedora-coreos/fedora-coreos-notes/","text":"Fedora coreOS notes Butane and ignition Butane is used for a user-friendly way to create ignition files for Fedora CoreOS. Create ignition file from butane config: butane --pretty --strict config.bu > config.ign Installation Once you have booted the Fedora CoreOS ISO, you can install it using the coreos-installer command. Its easier if you have the ignition file hosted somewhere accessible via URL. Install Fedora CoreOS to disk: coreos-installer install /dev/sda --image-url <URL_to_Fedora_CoreOS_image> --ignition-file <URL_to_ignition_file>","title":"Fedora coreOS"},{"location":"sysadmin/fedora-coreos/fedora-coreos-notes/#fedora-coreos-notes","text":"","title":"Fedora coreOS notes"},{"location":"sysadmin/fedora-coreos/fedora-coreos-notes/#butane-and-ignition","text":"Butane is used for a user-friendly way to create ignition files for Fedora CoreOS. Create ignition file from butane config: butane --pretty --strict config.bu > config.ign","title":"Butane and ignition"},{"location":"sysadmin/fedora-coreos/fedora-coreos-notes/#installation","text":"Once you have booted the Fedora CoreOS ISO, you can install it using the coreos-installer command. Its easier if you have the ignition file hosted somewhere accessible via URL. Install Fedora CoreOS to disk: coreos-installer install /dev/sda --image-url <URL_to_Fedora_CoreOS_image> --ignition-file <URL_to_ignition_file>","title":"Installation"},{"location":"virtual-machine/virtual-machine-notes/","text":"Virtual Machine Notes Installation and Setup Configuring virsh for non-root user Add your user to group libvirt Write the configuration to ~/.config/libvirt/libvirt.conf sudo usermod -a -G libvirt user mkdir -p ~/.config/libvirt/ echo 'uri_default = \"qemu:///system\"' | tee -a ~/.config/libvirt/libvirt.conf Enable Virtualization For installing virtual machines without graphics we need to have some things installed and then enable libvirt daemon apt install qemu qemu-kvm qemu-system qemu-utils \\ libvirt-clients libvirt-daemon-system virtinst \\ virt-manager bridge-utils # or dnf install @virtualization systemctl enable libvirtd Manage virtual machines with virsh Create a disk image for the virtual machine qemu-img create -f qcow2 ./name.qcow2 8G Run the virtual machine from serial with virt install The important thing is using some parameters with the virt install, disable the graphics and enable a serial console. --graphics none \\ --console pty,target_type=serial \\ --extra-args 'console=ttyS0,115200n8 serial' For the os-variant parameter, we need to know the system supported variants, you can do so with osinfo-query os If you are using an ISO, you can use the cdrom parameter --cdrom ./example.iso \\ Debian example: virt-install \\ --name debian11 \\ --memory 1024 \\ --disk path=./debian10.qcow2,size=8,format=qcow2,bus=virtio \\ --cpu host \\ --virt-type kvm \\ --vcpus 1 \\ --os-type linux \\ --os-variant debian11 \\ --network bridge=virbr0,model=virtio \\ --graphics none \\ --console pty,target_type=serial \\ --location 'http://your.url/installer' \\ --extra-args 'console=ttyS0,115200n8 serial' URLS: You may need to change architecture if running on aarch64 Debian Stable Debian OldStable Debian Testing CentOS-stream9 Alma Linux 8 Alma Linux 9 Fedora Everything 37 Converting from raw to qcow2 For converting raw (in this case a linux volume) to a qcow2 we must sparse it, so it does not use lots of space, in order to do this, first of all we need to install libguestfs-tools-c sh dnf install libguestfs-tools-c With that it will be installed the tool virt-sparsify , that is the one we need. Now we need to be sure that out /tmp directory is bigger than the raw image we are converting, may mount other drive in /tmp. In orther to do the convertion, we can use virt-sparsify /dev/mapper/VG-VM --convert qcow2 /out/VM.qcow2 --check-tmpdir fail The last flag is to check if the size of /tmp is enough. Mount qcow2 image For mounting: modprobe nbd max_part=8 qemu-nbd --connect=/dev/nbd0 ./image.qcow2 fdisk /dev/nbd0 -l mount /dev/nbd0p1 /mnt For unmounting: umount /mnt/somepoint/ qemu-nbd --disconnect /dev/nbd0 rmmod nbd Mount raw image or linux volume Create a loop device with losetup -f -P raw.img You can see the open files with: losetup -l fdisk -l And mount it with: mount /dev/loop0p1 /mnt/mypartition For unmounting and closing: umount /mnt/mypartition losetup -d /dev/loop0p1 Mount with virtiofsd I had a problem, I needed to mount a btrfs disk on a rhel9 vm, this is not supported, so I thought it would be a great idea to mount it on the Debian host and share it with virtiofsd, supporting selinux and all of that, it may not be the most secure way and it has some problems, so use it at your own risk. Upgrade Debian libvirt packages Debian 11 bullseye has an old libvirt package, so you need to upgrade them from backports, the packages are qemu qemu-kvm qemu-system qemu-utils libvirt-clients libvirt-daemon-system virtinst and after the upgrade you should restart libvirtd Run virtiofsd as a systemd service In order to run virtiofsd in a socket, you should run it separated this can be done with a systemd service: [Unit] Description=Virtiofsd for sharing disk WD-WX32D5143K0L Documentation=https://gitlab.com/virtio-fs/virtiofsd [Service] ExecStart=/usr/lib/qemu/virtiofsd --socket-path=/var/virtiofsd.sock \\ --socket-group=libvirt-qemu -o xattr,source=\"/mnt/Disk\",\\ xattrmap=\":map:security.selinux:trusted.virtiofs.:\",modcaps=+sys_admin [Install] WantedBy=multi-user.target The extra options are 'xattr' for enabling those, 'source' to declare the dir to share, 'xattrmap' so you can have different selinux context on the host and the guest, 'modcaps' so it is able to set trusted xattr. The service should run as root. Add the xml to the vm With virsh edit you should edit the domain xml to declare the socket <filesystem type='mount'> <driver type='virtiofs' queue='1024'/> <source socket='/var/virtiofsd.sock'/> <target dir='myDisk'/> <alias name='fs0'/> <address type='pci' domain='0x0000' bus='0x07' slot='0x00' function='0x0'/> </filesystem>","title":"Virtual Machine"},{"location":"virtual-machine/virtual-machine-notes/#virtual-machine-notes","text":"","title":"Virtual Machine Notes"},{"location":"virtual-machine/virtual-machine-notes/#installation-and-setup","text":"","title":"Installation and Setup"},{"location":"virtual-machine/virtual-machine-notes/#configuring-virsh-for-non-root-user","text":"Add your user to group libvirt Write the configuration to ~/.config/libvirt/libvirt.conf sudo usermod -a -G libvirt user mkdir -p ~/.config/libvirt/ echo 'uri_default = \"qemu:///system\"' | tee -a ~/.config/libvirt/libvirt.conf","title":"Configuring virsh for non-root user"},{"location":"virtual-machine/virtual-machine-notes/#enable-virtualization","text":"For installing virtual machines without graphics we need to have some things installed and then enable libvirt daemon apt install qemu qemu-kvm qemu-system qemu-utils \\ libvirt-clients libvirt-daemon-system virtinst \\ virt-manager bridge-utils # or dnf install @virtualization systemctl enable libvirtd","title":"Enable Virtualization"},{"location":"virtual-machine/virtual-machine-notes/#manage-virtual-machines-with-virsh","text":"","title":"Manage virtual machines with virsh"},{"location":"virtual-machine/virtual-machine-notes/#create-a-disk-image-for-the-virtual-machine","text":"qemu-img create -f qcow2 ./name.qcow2 8G","title":"Create a disk image for the virtual machine"},{"location":"virtual-machine/virtual-machine-notes/#run-the-virtual-machine-from-serial-with-virt-install","text":"The important thing is using some parameters with the virt install, disable the graphics and enable a serial console. --graphics none \\ --console pty,target_type=serial \\ --extra-args 'console=ttyS0,115200n8 serial' For the os-variant parameter, we need to know the system supported variants, you can do so with osinfo-query os If you are using an ISO, you can use the cdrom parameter --cdrom ./example.iso \\ Debian example: virt-install \\ --name debian11 \\ --memory 1024 \\ --disk path=./debian10.qcow2,size=8,format=qcow2,bus=virtio \\ --cpu host \\ --virt-type kvm \\ --vcpus 1 \\ --os-type linux \\ --os-variant debian11 \\ --network bridge=virbr0,model=virtio \\ --graphics none \\ --console pty,target_type=serial \\ --location 'http://your.url/installer' \\ --extra-args 'console=ttyS0,115200n8 serial' URLS: You may need to change architecture if running on aarch64 Debian Stable Debian OldStable Debian Testing CentOS-stream9 Alma Linux 8 Alma Linux 9 Fedora Everything 37","title":"Run the virtual machine from serial with virt install"},{"location":"virtual-machine/virtual-machine-notes/#converting-from-raw-to-qcow2","text":"For converting raw (in this case a linux volume) to a qcow2 we must sparse it, so it does not use lots of space, in order to do this, first of all we need to install libguestfs-tools-c sh dnf install libguestfs-tools-c With that it will be installed the tool virt-sparsify , that is the one we need. Now we need to be sure that out /tmp directory is bigger than the raw image we are converting, may mount other drive in /tmp. In orther to do the convertion, we can use virt-sparsify /dev/mapper/VG-VM --convert qcow2 /out/VM.qcow2 --check-tmpdir fail The last flag is to check if the size of /tmp is enough.","title":"Converting from raw to qcow2"},{"location":"virtual-machine/virtual-machine-notes/#mount-qcow2-image","text":"For mounting: modprobe nbd max_part=8 qemu-nbd --connect=/dev/nbd0 ./image.qcow2 fdisk /dev/nbd0 -l mount /dev/nbd0p1 /mnt For unmounting: umount /mnt/somepoint/ qemu-nbd --disconnect /dev/nbd0 rmmod nbd","title":"Mount qcow2 image"},{"location":"virtual-machine/virtual-machine-notes/#mount-raw-image-or-linux-volume","text":"Create a loop device with losetup -f -P raw.img You can see the open files with: losetup -l fdisk -l And mount it with: mount /dev/loop0p1 /mnt/mypartition For unmounting and closing: umount /mnt/mypartition losetup -d /dev/loop0p1","title":"Mount raw image or linux volume"},{"location":"virtual-machine/virtual-machine-notes/#mount-with-virtiofsd","text":"I had a problem, I needed to mount a btrfs disk on a rhel9 vm, this is not supported, so I thought it would be a great idea to mount it on the Debian host and share it with virtiofsd, supporting selinux and all of that, it may not be the most secure way and it has some problems, so use it at your own risk.","title":"Mount with virtiofsd"},{"location":"virtual-machine/virtual-machine-notes/#upgrade-debian-libvirt-packages","text":"Debian 11 bullseye has an old libvirt package, so you need to upgrade them from backports, the packages are qemu qemu-kvm qemu-system qemu-utils libvirt-clients libvirt-daemon-system virtinst and after the upgrade you should restart libvirtd","title":"Upgrade Debian libvirt packages"},{"location":"virtual-machine/virtual-machine-notes/#run-virtiofsd-as-a-systemd-service","text":"In order to run virtiofsd in a socket, you should run it separated this can be done with a systemd service: [Unit] Description=Virtiofsd for sharing disk WD-WX32D5143K0L Documentation=https://gitlab.com/virtio-fs/virtiofsd [Service] ExecStart=/usr/lib/qemu/virtiofsd --socket-path=/var/virtiofsd.sock \\ --socket-group=libvirt-qemu -o xattr,source=\"/mnt/Disk\",\\ xattrmap=\":map:security.selinux:trusted.virtiofs.:\",modcaps=+sys_admin [Install] WantedBy=multi-user.target The extra options are 'xattr' for enabling those, 'source' to declare the dir to share, 'xattrmap' so you can have different selinux context on the host and the guest, 'modcaps' so it is able to set trusted xattr. The service should run as root.","title":"Run virtiofsd as a systemd service"},{"location":"virtual-machine/virtual-machine-notes/#add-the-xml-to-the-vm","text":"With virsh edit you should edit the domain xml to declare the socket <filesystem type='mount'> <driver type='virtiofs' queue='1024'/> <source socket='/var/virtiofsd.sock'/> <target dir='myDisk'/> <alias name='fs0'/> <address type='pci' domain='0x0000' bus='0x07' slot='0x00' function='0x0'/> </filesystem>","title":"Add the xml to the vm"},{"location":"web/web-server-notes/","text":"Web server notes Nginx Basic nginx.conf this redirects all http to https and uses conf.d to configure other servers user nginx; worker_processes auto; pid /var/run/nginx.pid; events { worker_connections 1024; } http { sendfile on; tcp_nopush on; types_hash_max_size 2048; include /etc/nginx/mime.types; default_type application/octet-stream; gzip on; # Security # Certbot recommends : ssl_session_cache shared:le_nginx_SSL:10m; ssl_session_timeout 1440m; ssl_session_tickets off; ssl_protocols TLSv1.2 TLSv1.3; ssl_prefer_server_ciphers off; ssl_ciphers \"ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384\"; server_tokens off; client_header_buffer_size 1k; large_client_header_buffers 2 1k; add_header Strict-Transport-Security \"max-age=15768000; includeSubDomains\" always; add_header X-Frame-Options SAMEORIGIN; add_header X-Content-Type-Options nosniff; add_header X-XSS-Protection \"1; mode=block\"; # Logs access_log /var/log/nginx/access.log; error_log /var/log/nginx/error.log; # Default server { listen 80 default_server; listen [::]:80 default_server; server_name _; # Redirect to https return 301 https://$host$request_uri; } # Include services include /etc/nginx/conf.d/*.conf; } For running services you need to create a service.conf on the conf.d directory, something like this server { server_name your.domain; listen 443 ssl http2; ssl_certificate /etc/letsencrypt/live/your.domain/fullchain.pem; ssl_certificate_key /etc/letsencrypt/live/your.domain/privkey.pem; include /etc/letsencrypt/options-ssl-nginx.conf; ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; location / { proxy_http_version 1.1; proxy_pass http://127.0.0.1:8000; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header X-Forwarded-Proto $scheme; } } For cases when you need to send more data through nginx. server { server_name bigfiles.domain.tld; client_max_body_size 512M; ... } If you only want it on IPv6 server { listen [::]:80 default_server ipv6only=on; server_name _; ... } For proxy pass with selinux use: setsebool -P httpd_can_network_connect on Problems with files permissions and selinux , solve them with sudo grep nginx /var/log/audit/audit.log | audit2allow -M nginx > nginx.te \\ && sudo semodule -i nginx.pp Serving files server { ... root /directorie/to/serve; autoindex on; autoindex_exact_size off; autoindex_localtime on; } Authentication To generate a password file Only use -c when creating the file sudo htpasswd -c /etc/nginx/.htpasswd first_user Add this to your server config server { auth_basic \"Private sharing files\"; auth_basic_user_file /etc/nginx/.htpasswd; } Common error codes code class 1xx Informational 2xx Success 3xx Redirection 4xx Client Error 5xx Server Error return 400; - Bad Request: the HTTP request that was sent to the server has invalid syntax. return 401; - Unauthorized: that the user trying to access the resource has not been authenticated or has not been authenticated correctly. return 403; - Forbidden: that the user made a valid request but the server is refusing to serve the request, due to a lack of permission to access the requested resource return 404; - Not found: that the user is able to communicate with the server but it is unable to locate the requested file or resource. return 444; - Not return anything return 500; - Internal server error: that server cannot process the request for an unknown reason. Sometimes this code will appear when more specific 5xx errors are more appropriate. return 502; - Bad Gateway: that the server is a gateway or proxy server, and it is not receiving a valid response from the backend servers that should actually fulfill the request. return 503; - Gateway timeout: that the server is a gateway or proxy server, and it is not receiving a response from the backend servers within the allowed time period. Certbot Let's encrypt, has a service so you can easily get ssl certificates, the basic cerbot command can be installed with sudo dnf install certbot # If you want to use pluggins like nginx do it with pip sudo dnf install python3 augeas-libs sudo python3 -m venv /opt/certbot/ sudo /opt/certbot/bin/pip install --upgrade pip sudo /opt/certbot/bin/pip install certbot sudo ln -s /opt/certbot/bin/certbot /usr/bin/certbot echo \"0 0,12 * * * root /usr/bin/certbot renew -q\" | sudo tee -a /etc/crontab > /dev/null It is possible to get a certificate modifying a TXT record on the dns, the advantage is that you can use wildcards like *.domain.tld and there is no need to have a web server running or exposed. But you will have to renew this certificates manually every 90 days. sudo certbot --manual --preferred-challenges dns certonly The automated way is having a webserver exposed so letsencrypt can verify you own the domain, the requirements is having nginx up and running and public DNS records pointing to that server, but the advantage is that those certificates will automatically renew. sudo /opt/certbot/bin/pip install certbot-nginx sudo certbot certonly --nginx -d sub.domain.tld Using private SSL certificates and Certification Authority From vaultwarden wiki In cases you want ssl certificates but not need them to be public, you can sign your own ones and only trust them on your devices, this way there is no need of external authorities like letsencrypt and free use of any domain you want, even if not registrated. In the example, example.lan is the domain being example the name of the service The first step is creating the key of the Certification Authority. openssl genpkey -algorithm RSA -aes128 -out private-ca.key -outform PEM -pkeyopt rsa_keygen_bits:2048 And for creating the certificate, that will work for 10 years, this is the certificate that need to be trusted by the client devices. openssl req -x509 -new -nodes -sha256 -days 3650 -key private-ca.key -out self-signed-ca-cert.crt In order to create domain certificates, create a key openssl genpkey -algorithm RSA -out service.key -outform PEM -pkeyopt rsa_keygen_bits:2048 And create a certificate request openssl req -new -key service.key -out service.csr Fill the configuration file service.ext , change the dns alt_names accordingly. authorityKeyIdentifier=keyid,issuer basicConstraints=CA:FALSE keyUsage = digitalSignature, nonRepudiation, keyEncipherment, dataEncipherment extendedKeyUsage = serverAuth subjectAltName = @alt_names [alt_names] DNS.1 = service.lan DNS.2 = www.service.lan And finaly generate the certificate signed from the C.A. openssl x509 -req -in service.csr -CA self-signed-ca-cert.crt -CAkey private-ca.key -CAcreateserial -out service.crt -days 365 -sha256 -extfile service.ext To use this certificates on Nginx copy the service.crt and service.key file to the server in a directory it can be accessed by the nginx process. CHANGE PERMITIONS TO 400 AND CHOWN TO ROOT ssl_certificate /etc/nginx/certs/service.crt; ssl_certificate_key /etc/nginx/certs/vaultwarden.key; Finally, copy the self-signed-ca-cert.crt to every device and authorize it.","title":"Web"},{"location":"web/web-server-notes/#web-server-notes","text":"","title":"Web server notes"},{"location":"web/web-server-notes/#nginx","text":"Basic nginx.conf this redirects all http to https and uses conf.d to configure other servers user nginx; worker_processes auto; pid /var/run/nginx.pid; events { worker_connections 1024; } http { sendfile on; tcp_nopush on; types_hash_max_size 2048; include /etc/nginx/mime.types; default_type application/octet-stream; gzip on; # Security # Certbot recommends : ssl_session_cache shared:le_nginx_SSL:10m; ssl_session_timeout 1440m; ssl_session_tickets off; ssl_protocols TLSv1.2 TLSv1.3; ssl_prefer_server_ciphers off; ssl_ciphers \"ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384\"; server_tokens off; client_header_buffer_size 1k; large_client_header_buffers 2 1k; add_header Strict-Transport-Security \"max-age=15768000; includeSubDomains\" always; add_header X-Frame-Options SAMEORIGIN; add_header X-Content-Type-Options nosniff; add_header X-XSS-Protection \"1; mode=block\"; # Logs access_log /var/log/nginx/access.log; error_log /var/log/nginx/error.log; # Default server { listen 80 default_server; listen [::]:80 default_server; server_name _; # Redirect to https return 301 https://$host$request_uri; } # Include services include /etc/nginx/conf.d/*.conf; } For running services you need to create a service.conf on the conf.d directory, something like this server { server_name your.domain; listen 443 ssl http2; ssl_certificate /etc/letsencrypt/live/your.domain/fullchain.pem; ssl_certificate_key /etc/letsencrypt/live/your.domain/privkey.pem; include /etc/letsencrypt/options-ssl-nginx.conf; ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; location / { proxy_http_version 1.1; proxy_pass http://127.0.0.1:8000; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header X-Forwarded-Proto $scheme; } } For cases when you need to send more data through nginx. server { server_name bigfiles.domain.tld; client_max_body_size 512M; ... } If you only want it on IPv6 server { listen [::]:80 default_server ipv6only=on; server_name _; ... } For proxy pass with selinux use: setsebool -P httpd_can_network_connect on Problems with files permissions and selinux , solve them with sudo grep nginx /var/log/audit/audit.log | audit2allow -M nginx > nginx.te \\ && sudo semodule -i nginx.pp","title":"Nginx"},{"location":"web/web-server-notes/#serving-files","text":"server { ... root /directorie/to/serve; autoindex on; autoindex_exact_size off; autoindex_localtime on; }","title":"Serving files"},{"location":"web/web-server-notes/#authentication","text":"To generate a password file Only use -c when creating the file sudo htpasswd -c /etc/nginx/.htpasswd first_user Add this to your server config server { auth_basic \"Private sharing files\"; auth_basic_user_file /etc/nginx/.htpasswd; }","title":"Authentication"},{"location":"web/web-server-notes/#common-error-codes","text":"code class 1xx Informational 2xx Success 3xx Redirection 4xx Client Error 5xx Server Error return 400; - Bad Request: the HTTP request that was sent to the server has invalid syntax. return 401; - Unauthorized: that the user trying to access the resource has not been authenticated or has not been authenticated correctly. return 403; - Forbidden: that the user made a valid request but the server is refusing to serve the request, due to a lack of permission to access the requested resource return 404; - Not found: that the user is able to communicate with the server but it is unable to locate the requested file or resource. return 444; - Not return anything return 500; - Internal server error: that server cannot process the request for an unknown reason. Sometimes this code will appear when more specific 5xx errors are more appropriate. return 502; - Bad Gateway: that the server is a gateway or proxy server, and it is not receiving a valid response from the backend servers that should actually fulfill the request. return 503; - Gateway timeout: that the server is a gateway or proxy server, and it is not receiving a response from the backend servers within the allowed time period.","title":"Common error codes"},{"location":"web/web-server-notes/#certbot","text":"Let's encrypt, has a service so you can easily get ssl certificates, the basic cerbot command can be installed with sudo dnf install certbot # If you want to use pluggins like nginx do it with pip sudo dnf install python3 augeas-libs sudo python3 -m venv /opt/certbot/ sudo /opt/certbot/bin/pip install --upgrade pip sudo /opt/certbot/bin/pip install certbot sudo ln -s /opt/certbot/bin/certbot /usr/bin/certbot echo \"0 0,12 * * * root /usr/bin/certbot renew -q\" | sudo tee -a /etc/crontab > /dev/null It is possible to get a certificate modifying a TXT record on the dns, the advantage is that you can use wildcards like *.domain.tld and there is no need to have a web server running or exposed. But you will have to renew this certificates manually every 90 days. sudo certbot --manual --preferred-challenges dns certonly The automated way is having a webserver exposed so letsencrypt can verify you own the domain, the requirements is having nginx up and running and public DNS records pointing to that server, but the advantage is that those certificates will automatically renew. sudo /opt/certbot/bin/pip install certbot-nginx sudo certbot certonly --nginx -d sub.domain.tld","title":"Certbot"},{"location":"web/web-server-notes/#using-private-ssl-certificates-and-certification-authority","text":"From vaultwarden wiki In cases you want ssl certificates but not need them to be public, you can sign your own ones and only trust them on your devices, this way there is no need of external authorities like letsencrypt and free use of any domain you want, even if not registrated. In the example, example.lan is the domain being example the name of the service The first step is creating the key of the Certification Authority. openssl genpkey -algorithm RSA -aes128 -out private-ca.key -outform PEM -pkeyopt rsa_keygen_bits:2048 And for creating the certificate, that will work for 10 years, this is the certificate that need to be trusted by the client devices. openssl req -x509 -new -nodes -sha256 -days 3650 -key private-ca.key -out self-signed-ca-cert.crt In order to create domain certificates, create a key openssl genpkey -algorithm RSA -out service.key -outform PEM -pkeyopt rsa_keygen_bits:2048 And create a certificate request openssl req -new -key service.key -out service.csr Fill the configuration file service.ext , change the dns alt_names accordingly. authorityKeyIdentifier=keyid,issuer basicConstraints=CA:FALSE keyUsage = digitalSignature, nonRepudiation, keyEncipherment, dataEncipherment extendedKeyUsage = serverAuth subjectAltName = @alt_names [alt_names] DNS.1 = service.lan DNS.2 = www.service.lan And finaly generate the certificate signed from the C.A. openssl x509 -req -in service.csr -CA self-signed-ca-cert.crt -CAkey private-ca.key -CAcreateserial -out service.crt -days 365 -sha256 -extfile service.ext To use this certificates on Nginx copy the service.crt and service.key file to the server in a directory it can be accessed by the nginx process. CHANGE PERMITIONS TO 400 AND CHOWN TO ROOT ssl_certificate /etc/nginx/certs/service.crt; ssl_certificate_key /etc/nginx/certs/vaultwarden.key; Finally, copy the self-signed-ca-cert.crt to every device and authorize it.","title":"Using private SSL certificates and Certification Authority"}]}